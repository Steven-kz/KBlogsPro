<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.67" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://steven-kz.github.io/KBlogsPro/KBlogsPro/java/Common/ElasticSearch.html"><meta property="og:site_name" content="Flowers"><meta property="og:title" content="ElasticSearch"><meta property="og:description" content="ElasticSearch ä¸€ã€ElasticSearchæ˜¯ä»€ä¹ˆ åˆ†å¸ƒå¼æœç´¢å’Œåˆ†æå¼•æ“ï¼Œä¸»è¦å®ç°è¿‘ä¹å®æ—¶çš„æœç´¢å’Œåˆ†æã€‚å¯ä»¥å®ç°æµ·é‡æ•°æ®çš„å­˜å‚¨ï¼ˆâ½€æŒPBçº§åˆ«çš„æ•° æ®ï¼‰ï¼Œå¯ä»¥å®ç°å¿«é€Ÿæœç´¢ï¼ˆå€’æ’ç´¢å¼•ï¼‰è¿˜å¯ä»¥å®ç°æ•°æ®åˆ†æå¤„ç†. å®ç°æµ·é‡æ•°æ®ä¸‹å¿«é€Ÿæœç´¢ ç»å¯¹ä¸ä½¿â½¤æ¨¡ç³ŠæŸ¥è¯¢ï¼Œå› ä¸ºæ€§èƒ½å¤ªä½ã€‚ è§£å†³æµ·é‡æ•°æ®çš„å¿«é€Ÿæœç´¢ï¼Œå°±éœ€è¦ä½¿â½¤å…¨â½‚æ£€ç´¢æŠ€æœ¯ï¼Œé€‰æ‹©ElasticSearch å¸‚â¾¯ä¸Šæœ‰å…¨â½‚æ£€ç´¢æŠ€æœ¯ï¼šLuceneã€Solr(åº•å±‚ï¼šLucene)ã€ElasticSearchï¼ˆåº•å±‚ï¼šLuceneï¼‰ â½¬å‰å¸‚â¾¯ä¸Šï¼šElasticSearch ELKï¼šElasticSearchï¼ˆå­˜å‚¨ã€æœç´¢ï¼‰+Logstashï¼ˆé‡‡é›†ï¼‰+Kibanaï¼ˆå¯è§†åŒ–ï¼‰ â½‡å¿—å¹³å° ä¸»è¦å­˜å‚¨çš„æŸ¥è¯¢çš„æ•°æ®ï¼Œâ½€æŒæµ·é‡æ•°æ®å­˜å‚¨å’ŒæŸ¥è¯¢ï¼Œâ¼€å®šè¦å¸¦æ¡ä»¶ ä¸»æµï¼šElasticSearch"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2023-10-10T17:13:50.000Z"><meta property="article:author" content="Kou"><meta property="article:published_time" content="2022-01-04T00:00:00.000Z"><meta property="article:modified_time" content="2023-10-10T17:13:50.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"ElasticSearch","image":[""],"datePublished":"2022-01-04T00:00:00.000Z","dateModified":"2023-10-10T17:13:50.000Z","author":[{"@type":"Person","name":"Kou","url":"https://steven-kz.github.io/KBlogsPro/"}]}</script><link rel="icon" href="/KBlogsPro/favicon.ico"><title>ElasticSearch | Flowers</title><meta name="description" content="ElasticSearch ä¸€ã€ElasticSearchæ˜¯ä»€ä¹ˆ åˆ†å¸ƒå¼æœç´¢å’Œåˆ†æå¼•æ“ï¼Œä¸»è¦å®ç°è¿‘ä¹å®æ—¶çš„æœç´¢å’Œåˆ†æã€‚å¯ä»¥å®ç°æµ·é‡æ•°æ®çš„å­˜å‚¨ï¼ˆâ½€æŒPBçº§åˆ«çš„æ•° æ®ï¼‰ï¼Œå¯ä»¥å®ç°å¿«é€Ÿæœç´¢ï¼ˆå€’æ’ç´¢å¼•ï¼‰è¿˜å¯ä»¥å®ç°æ•°æ®åˆ†æå¤„ç†. å®ç°æµ·é‡æ•°æ®ä¸‹å¿«é€Ÿæœç´¢ ç»å¯¹ä¸ä½¿â½¤æ¨¡ç³ŠæŸ¥è¯¢ï¼Œå› ä¸ºæ€§èƒ½å¤ªä½ã€‚ è§£å†³æµ·é‡æ•°æ®çš„å¿«é€Ÿæœç´¢ï¼Œå°±éœ€è¦ä½¿â½¤å…¨â½‚æ£€ç´¢æŠ€æœ¯ï¼Œé€‰æ‹©ElasticSearch å¸‚â¾¯ä¸Šæœ‰å…¨â½‚æ£€ç´¢æŠ€æœ¯ï¼šLuceneã€Solr(åº•å±‚ï¼šLucene)ã€ElasticSearchï¼ˆåº•å±‚ï¼šLuceneï¼‰ â½¬å‰å¸‚â¾¯ä¸Šï¼šElasticSearch ELKï¼šElasticSearchï¼ˆå­˜å‚¨ã€æœç´¢ï¼‰+Logstashï¼ˆé‡‡é›†ï¼‰+Kibanaï¼ˆå¯è§†åŒ–ï¼‰ â½‡å¿—å¹³å° ä¸»è¦å­˜å‚¨çš„æŸ¥è¯¢çš„æ•°æ®ï¼Œâ½€æŒæµ·é‡æ•°æ®å­˜å‚¨å’ŒæŸ¥è¯¢ï¼Œâ¼€å®šè¦å¸¦æ¡ä»¶ ä¸»æµï¼šElasticSearch">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/KBlogsPro/assets/style-e3478dba.css" as="style"><link rel="stylesheet" href="/KBlogsPro/assets/style-e3478dba.css">
    <link rel="modulepreload" href="/KBlogsPro/assets/app-eb665f75.js"><link rel="modulepreload" href="/KBlogsPro/assets/ElasticSearch.html-af5eebf7.js"><link rel="modulepreload" href="/KBlogsPro/assets/ElasticSearch.html-47c78a09.js"><link rel="prefetch" href="/KBlogsPro/assets/intro.html-18753adc.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-f8e4909f.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/slides.html-8629d806.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/Mysql.html-bf5cf9ae.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/MySQLBasic.html-380b003b.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-82543e60.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/disable.html-329019c1.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/encrypt.html-a66c54c2.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/markdown.html-6a8afc31.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/page.html-655f305d.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-7b6f2efb.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-3835efd5.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-3723bbf8.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/love.html-aac3ea22.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-636ecce3.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/AlibabaToolkit.html-00d3fa93.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/Docker.html-29f6d1bf.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/DockerRedis.html-16990f7b.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/linux.html-27f9e236.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/MinIO.html-513caff0.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/Natapp.html-b765532e.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/Nginx.html-74dd2bff.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/PicGo.html-6558394f.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-f6b9d18b.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/Squid.html-0a41596e.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/Nvm.html-f1d7b39a.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-75435635.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/Vue-CLI.html-4a76cfa2.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/Mysql.html-d2505edd.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/MysqlIndex.html-2ff70435.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-43ec7dfb.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/Redis.html-9e3b6820.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/class.html-2a2a1b77.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/Collection.html-d1b1b3ad.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/filter.html-c0255cbe.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/JavaBasic.html-144ebd3e.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/JDK.html-42682ec0.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/JVM_GC.html-2ef5b2f5.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/RabbitMQ.html-dbd138b5.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-6547253a.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/RedLock.html-61ff5a30.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/SpringEvent.html-364d23f8.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/ThreadPool.html-b2f0e854.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/Beetl.html-99e18c17.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/JSR303.html-076f534e.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/MDC.html-123b48f0.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/RabbitMQ.html-48da8411.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-758442a3.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/request.html-d8f2aac2.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/ThreadLocal.html-cf413742.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/ThreadPool.html-957a2f28.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/WebMagic.html-03e86c0d.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/gcz.html-c95a6752.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/proxy.html-862ac363.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-a0c3caee.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/singleton.html-75d2df09.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/zr.html-c8b54da0.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/404.html-329da0c0.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-dd687c27.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-b0fad644.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-63abec3b.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-ba26858f.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-4888a141.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-dedd7886.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-69464689.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/intro.html-6c948c8a.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-5cac597c.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/slides.html-4050bd25.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/Mysql.html-851ed92a.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/MySQLBasic.html-8f5ccf69.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-9a4d0edf.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/disable.html-81d3d5b5.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/encrypt.html-4791fbf5.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/markdown.html-39c75085.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/page.html-374b6851.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-3e78f8b3.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-d2e94668.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-6661ce0a.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/love.html-576d5cbf.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-8bbcf1cb.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/AlibabaToolkit.html-18a23c1b.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/Docker.html-2af5a178.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/DockerRedis.html-cd9edf8f.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/linux.html-57efbe03.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/MinIO.html-35c8724b.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/Natapp.html-121632de.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/Nginx.html-eed5a2b5.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/PicGo.html-9093284e.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-86d07e6e.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/Squid.html-c57cd43a.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/Nvm.html-3213c659.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-13848a23.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/Vue-CLI.html-b75f3fb9.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/Mysql.html-08789136.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/MysqlIndex.html-2369bfe3.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-742e62a7.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/Redis.html-f34e98d1.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/class.html-0a2c789f.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/Collection.html-dbb1bd52.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/filter.html-0047a369.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/JavaBasic.html-e8b83b93.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/JDK.html-6cdb320e.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/JVM_GC.html-441e6520.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/RabbitMQ.html-f41747c4.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-88ca30c8.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/RedLock.html-2a832c58.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/SpringEvent.html-91a86e13.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/ThreadPool.html-fbc09133.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/Beetl.html-3f14edd9.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/JSR303.html-70f0346e.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/MDC.html-09f6845b.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/RabbitMQ.html-a591cc36.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-cff63487.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/request.html-35840e61.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/ThreadLocal.html-6cf9f2e2.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/ThreadPool.html-ee45a9ad.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/WebMagic.html-58770c87.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/gcz.html-8d17d75d.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/proxy.html-db9621bf.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-b5e9856c.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/singleton.html-0952c0ad.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/zr.html-609d109a.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/404.html-0ae10e5c.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-fd65f77d.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-fbf189c1.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-07ee7969.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-7702d445.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-c1320f01.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-d5c62655.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index.html-285b5de6.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/auto-fe80bb03.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/index-2bf332f6.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/flowchart-c441f34d.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/mermaid.core-6ca8748d.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/highlight.esm-75b11b9d.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/markdown.esm-9d5bc2ce.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/math.esm-70a288c8.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/notes.esm-a106bb2c.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/reveal.esm-1a4c3ae7.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/search.esm-7e6792e2.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/zoom.esm-b83b91d0.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/VuePlayground-18ad186f.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/photoswipe.esm-1464cdb9.js" as="script"><link rel="prefetch" href="/KBlogsPro/assets/SearchResult-4cfc4e62.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="vp-link vp-brand vp-brand" href="/KBlogsPro/"><img class="vp-nav-logo" src="/KBlogsPro/logo.png" alt="Flowers"><!----><span class="vp-site-name hide-in-pad">Flowers</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a aria-label="ä¸»é¡µ" class="vp-link nav-link nav-link" href="/KBlogsPro/"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a aria-label="Java" class="vp-link nav-link active nav-link active" href="/KBlogsPro/java/"><img class="icon" src="/KBlogsPro/assets/icon/java.svg" no-view style="">Java<!----></a></div><div class="nav-item hide-in-mobile"><a aria-label="è¿ç»´" class="vp-link nav-link nav-link" href="/KBlogsPro/serverCloud/"><img class="icon" src="/KBlogsPro/assets/icon/serviceCloud.svg" no-view style="">è¿ç»´<!----></a></div><div class="nav-item hide-in-mobile"><a aria-label="Database" class="vp-link nav-link nav-link" href="/KBlogsPro/database/"><img class="icon" src="/KBlogsPro/assets/icon/database.svg" no-view style="">Database<!----></a></div><div class="nav-item hide-in-mobile"><a aria-label="å‰ç«¯" class="vp-link nav-link nav-link" href="/KBlogsPro/vue/"><img class="icon" src="/KBlogsPro/assets/icon/vuejs.svg" no-view style="">å‰ç«¯<!----></a></div><div class="nav-item hide-in-mobile"><a aria-label="é¢è¯•" class="vp-link nav-link nav-link" href="/KBlogsPro/interview/"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span>é¢è¯•<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="å¸¸ç”¨ç½‘ç«™"><span class="title"><span class="font-icon icon fa-fw fa-sm fas fa-explore" style=""></span>å¸¸ç”¨ç½‘ç«™</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="https://mvnrepository.com/" rel="noopener noreferrer" target="_blank" aria-label="Mavenä¸­å¤®ä»“åº“" class="nav-link"><!---->Mavenä¸­å¤®ä»“åº“<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-item"><a href="https://www.sojson.com/" rel="noopener noreferrer" target="_blank" aria-label="JSONè§£æ" class="nav-link"><!---->JSONè§£æ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-item"><a href="https://pdfbox.apache.org/" rel="noopener noreferrer" target="_blank" aria-label="PDFBox" class="nav-link"><!---->PDFBox<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-item"><a href="https://npmmirror.com/" rel="noopener noreferrer" target="_blank" aria-label="NPMé•œåƒç«™" class="nav-link"><!---->NPMé•œåƒç«™<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-item"><a href="https://ghproxy.com/" rel="noopener noreferrer" target="_blank" aria-label="GitHubåŠ é€Ÿ" class="nav-link"><!---->GitHubåŠ é€Ÿ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-item"><a href="https://www.bootcdn.cn/" rel="noopener noreferrer" target="_blank" aria-label="BootCDN" class="nav-link"><!---->BootCDN<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-item"><a href="https://hub.daocloud.io/" rel="noopener noreferrer" target="_blank" aria-label="DaoCloud" class="nav-link"><!---->DaoCloud<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-item"><a href="http://redisdoc.com/index.html" rel="noopener noreferrer" target="_blank" aria-label="Rediså‘½ä»¤" class="nav-link"><!---->Rediså‘½ä»¤<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-item"><a href="https://3.jetbra.in/" rel="noopener noreferrer" target="_blank" aria-label="JetBrainæ¿€æ´»" class="nav-link"><!---->JetBrainæ¿€æ´»<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-item"><a href="https://c.runoob.com/front-end/8006/" rel="noopener noreferrer" target="_blank" aria-label="æ–‡æœ¬å¯¹æ¯”å·¥å…·" class="nav-link"><!---->æ–‡æœ¬å¯¹æ¯”å·¥å…·<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-item"><a href="https://c.runoob.com/front-end/854/" rel="noopener noreferrer" target="_blank" aria-label="æ­£åˆ™åœ¨çº¿å·¥å…·" class="nav-link"><!---->æ­£åˆ™åœ¨çº¿å·¥å…·<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-item"><a href="https://developers.google.cn/" rel="noopener noreferrer" target="_blank" aria-label="Googleå¼€å‘è€…" class="nav-link"><!---->Googleå¼€å‘è€…<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li></ul></button></div></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><div class="nav-item hide-in-mobile"><button type="button" class="outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="search-pro-button" role="search" aria-label="æœç´¢"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">æœç´¢</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><!--[--><a aria-label="ä¸»é¡µ" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/KBlogsPro/"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>ä¸»é¡µ<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><img class="icon" src="/KBlogsPro/assets/icon/serviceCloud.svg" no-view style=""><a aria-label="è¿ç»´" class="vp-link nav-link vp-sidebar-title nav-link vp-sidebar-title" href="/KBlogsPro/serverCloud/"><!---->è¿ç»´<!----></a><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><a aria-label="é¢è¯•" class="vp-link nav-link vp-sidebar-title nav-link vp-sidebar-title" href="/KBlogsPro/interview/"><!---->é¢è¯•<!----></a><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable active" type="button"><img class="icon" src="/KBlogsPro/assets/icon/java.svg" no-view style=""><a aria-label="Java" class="vp-link nav-link active vp-sidebar-title nav-link active vp-sidebar-title" href="/KBlogsPro/java/"><!---->Java<!----></a><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">è®¾è®¡æ¨¡å¼</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable active" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">Common</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><!--[--><a aria-label="å‚æ•°æ ¡éªŒçš„å‡ ç§æ–¹å¼" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/KBlogsPro/java/Common/JSR303.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>å‚æ•°æ ¡éªŒçš„å‡ ç§æ–¹å¼<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Beetl" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/KBlogsPro/java/Common/Beetl.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>Beetl<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="ElasticSearch" class="vp-link nav-link active vp-sidebar-link vp-sidebar-page active nav-link active vp-sidebar-link vp-sidebar-page active" href="/KBlogsPro/java/Common/ElasticSearch.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>ElasticSearch<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="ä¸€ã€ElasticSearchæ˜¯ä»€ä¹ˆ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#ä¸€ã€elasticsearchæ˜¯ä»€ä¹ˆ"><!---->ä¸€ã€ElasticSearchæ˜¯ä»€ä¹ˆ<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="1.1Elasticsearchçš„ç‰¹æ€§" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_1-1elasticsearchçš„ç‰¹æ€§"><!---->1.1Elasticsearchçš„ç‰¹æ€§<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="1.2 åŸºæœ¬æ¦‚å¿µ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_1-2-åŸºæœ¬æ¦‚å¿µ"><!---->1.2 åŸºæœ¬æ¦‚å¿µ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="1.3 å€’æ’ç´¢å¼•" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_1-3-å€’æ’ç´¢å¼•"><!---->1.3 å€’æ’ç´¢å¼•<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="1.4 ESç»“æ„" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_1-4-esç»“æ„"><!---->1.4 ESç»“æ„<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="äºŒã€æ­å»ºES Kibana" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#äºŒã€æ­å»ºes-kibana"><!---->äºŒã€æ­å»ºES Kibana<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="2.1 å®‰è£…docker-compose" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_2-1-å®‰è£…docker-compose"><!---->2.1 å®‰è£…docker-compose<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="2.2 æ‹‰èµ·é•œåƒ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_2-2-æ‹‰èµ·é•œåƒ"><!---->2.2 æ‹‰èµ·é•œåƒ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="2.3 IKåˆ†è¯å™¨" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_2-3-ikåˆ†è¯å™¨"><!---->2.3 IKåˆ†è¯å™¨<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="2.4 è®¾ç½®å¯†ç " class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_2-4-è®¾ç½®å¯†ç "><!---->2.4 è®¾ç½®å¯†ç <!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="ä¸‰ã€ESæ“ä½œ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#ä¸‰ã€esæ“ä½œ"><!---->ä¸‰ã€ESæ“ä½œ<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="3.1 Es Fieldå¯ä»¥æŒ‡å®šç±»å‹" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_3-1-es-fieldå¯ä»¥æŒ‡å®šç±»å‹"><!---->3.1 Es Fieldå¯ä»¥æŒ‡å®šç±»å‹<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="3.2 Kibanaå¿«æ·é”®æ“ä½œ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_3-2-kibanaå¿«æ·é”®æ“ä½œ"><!---->3.2 Kibanaå¿«æ·é”®æ“ä½œ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="3.3 ç´¢å¼•æ“ä½œ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_3-3-ç´¢å¼•æ“ä½œ"><!---->3.3 ç´¢å¼•æ“ä½œ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="3.4 æ–‡æ¡£æ“ä½œ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_3-4-æ–‡æ¡£æ“ä½œ"><!---->3.4 æ–‡æ¡£æ“ä½œ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="3.5 kibana å¯è§†åŒ–ç•Œé¢ä¸­å¯ä»¥çœ‹åˆ° åˆ›å»ºçš„ç´¢å¼•ä¿¡æ¯" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_3-5-kibana-å¯è§†åŒ–ç•Œé¢ä¸­å¯ä»¥çœ‹åˆ°-åˆ›å»ºçš„ç´¢å¼•ä¿¡æ¯"><!---->3.5 kibana å¯è§†åŒ–ç•Œé¢ä¸­å¯ä»¥çœ‹åˆ° åˆ›å»ºçš„ç´¢å¼•ä¿¡æ¯<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="å››ã€Javaæ“ä½œES Demo *" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#å››ã€javaæ“ä½œes-demo"><!---->å››ã€Javaæ“ä½œES Demo *<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="äº”ã€ESæŸ¥è¯¢ *" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#äº”ã€esæŸ¥è¯¢"><!---->äº”ã€ESæŸ¥è¯¢ *<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="5.1 termæŸ¥è¯¢" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_5-1-termæŸ¥è¯¢"><!---->5.1 termæŸ¥è¯¢<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5.2 termsæŸ¥è¯¢" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_5-2-termsæŸ¥è¯¢"><!---->5.2 termsæŸ¥è¯¢<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5.3 matchæŸ¥è¯¢" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_5-3-matchæŸ¥è¯¢"><!---->5.3 matchæŸ¥è¯¢<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5.4 multi_matchæŸ¥è¯¢" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_5-4-multi-matchæŸ¥è¯¢"><!---->5.4 multi_matchæŸ¥è¯¢<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5.5 idsæŸ¥è¯¢" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_5-5-idsæŸ¥è¯¢"><!---->5.5 idsæŸ¥è¯¢<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5.6 prefixæŸ¥è¯¢" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_5-6-prefixæŸ¥è¯¢"><!---->5.6 prefixæŸ¥è¯¢<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5.7 fuzzyæŸ¥è¯¢" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_5-7-fuzzyæŸ¥è¯¢"><!---->5.7 fuzzyæŸ¥è¯¢<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5.8 wildcardæŸ¥è¯¢" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_5-8-wildcardæŸ¥è¯¢"><!---->5.8 wildcardæŸ¥è¯¢<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5.9 rangeæŸ¥è¯¢" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_5-9-rangeæŸ¥è¯¢"><!---->5.9 rangeæŸ¥è¯¢<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5.10 regexpæŸ¥è¯¢" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_5-10-regexpæŸ¥è¯¢"><!---->5.10 regexpæŸ¥è¯¢<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5.11 æ·±åˆ†é¡µScroll" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_5-11-æ·±åˆ†é¡µscroll"><!---->5.11 æ·±åˆ†é¡µScroll<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5.12 delete-by-query" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_5-12-delete-by-query"><!---->5.12 delete-by-query<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5.13 boolæŸ¥è¯¢" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_5-13-boolæŸ¥è¯¢"><!---->5.13 boolæŸ¥è¯¢<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5.14 filteræŸ¥è¯¢" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_5-14-filteræŸ¥è¯¢"><!---->5.14 filteræŸ¥è¯¢<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5.15 é«˜äº®æŸ¥è¯¢" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_5-15-é«˜äº®æŸ¥è¯¢"><!---->5.15 é«˜äº®æŸ¥è¯¢<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5.16 èšåˆæŸ¥è¯¢" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_5-16-èšåˆæŸ¥è¯¢"><!---->5.16 èšåˆæŸ¥è¯¢<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5.17 åœ°å›¾ç»çº¬åº¦æœç´¢" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/KBlogsPro/java/Common/ElasticSearch.html#_5-17-åœ°å›¾ç»çº¬åº¦æœç´¢"><!---->5.17 åœ°å›¾ç»çº¬åº¦æœç´¢<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a aria-label="MDCé“¾è·¯è¿½è¸ª" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/KBlogsPro/java/Common/MDC.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>MDCé“¾è·¯è¿½è¸ª<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="MQ" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/KBlogsPro/java/Common/RabbitMQ.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>MQ<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="requestè¯·æ±‚ä½“ä¸¢å¤±" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/KBlogsPro/java/Common/request.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>requestè¯·æ±‚ä½“ä¸¢å¤±<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="ThreadLocal" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/KBlogsPro/java/Common/ThreadLocal.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>ThreadLocal<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="ThreadPool" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/KBlogsPro/java/Common/ThreadPool.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>ThreadPool<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="WebMagic" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/KBlogsPro/java/Common/WebMagic.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>WebMagic<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li></ul></section></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><img class="icon" src="/KBlogsPro/assets/icon/database.svg" no-view style=""><a aria-label="Database" class="vp-link nav-link vp-sidebar-title nav-link vp-sidebar-title" href="/KBlogsPro/database/"><!---->Database<!----></a><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><img class="icon" src="/KBlogsPro/assets/icon/vuejs.svg" no-view style=""><a aria-label="vue" class="vp-link nav-link vp-sidebar-title nav-link vp-sidebar-title" href="/KBlogsPro/vue/"><!---->vue<!----></a><span class="vp-arrow end"></span></button><!----></section></li><li><!--[--><a aria-label="ä»‹ç»é¡µ" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/KBlogsPro/intro.html"><span class="font-icon icon fa-fw fa-sm fas fa-circle-info" style=""></span>ä»‹ç»é¡µ<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-love" style=""></span><a aria-label="love" class="vp-link nav-link vp-sidebar-title nav-link vp-sidebar-title" href="/KBlogsPro/love/"><!---->love<!----></a><span class="vp-arrow end"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>ElasticSearch</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://steven-kz.github.io/KBlogsPro/" target="_blank" rel="noopener noreferrer">Kou</a></span><span property="author" content="Kou"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2022-01-04T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 18 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT18M"></span><!----><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/KBlogsPro/#ä¸€ã€elasticsearchæ˜¯ä»€ä¹ˆ">ä¸€ã€ElasticSearchæ˜¯ä»€ä¹ˆ</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_1-1elasticsearchçš„ç‰¹æ€§">1.1Elasticsearchçš„ç‰¹æ€§</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_1-2-åŸºæœ¬æ¦‚å¿µ">1.2 åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_1-3-å€’æ’ç´¢å¼•">1.3 å€’æ’ç´¢å¼•</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_1-4-esç»“æ„">1.4 ESç»“æ„</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/KBlogsPro/#äºŒã€æ­å»ºes-kibana">äºŒã€æ­å»ºES Kibana</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_2-1-å®‰è£…docker-compose">2.1 å®‰è£…docker-compose</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_2-2-æ‹‰èµ·é•œåƒ">2.2 æ‹‰èµ·é•œåƒ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_2-3-ikåˆ†è¯å™¨">2.3 IKåˆ†è¯å™¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_2-4-è®¾ç½®å¯†ç ">2.4 è®¾ç½®å¯†ç </a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/KBlogsPro/#ä¸‰ã€esæ“ä½œ">ä¸‰ã€ESæ“ä½œ</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_3-1-es-fieldå¯ä»¥æŒ‡å®šç±»å‹">3.1 Es Fieldå¯ä»¥æŒ‡å®šç±»å‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_3-2-kibanaå¿«æ·é”®æ“ä½œ">3.2 Kibanaå¿«æ·é”®æ“ä½œ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_3-3-ç´¢å¼•æ“ä½œ">3.3 ç´¢å¼•æ“ä½œ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_3-4-æ–‡æ¡£æ“ä½œ">3.4 æ–‡æ¡£æ“ä½œ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_3-5-kibana-å¯è§†åŒ–ç•Œé¢ä¸­å¯ä»¥çœ‹åˆ°-åˆ›å»ºçš„ç´¢å¼•ä¿¡æ¯">3.5 kibana å¯è§†åŒ–ç•Œé¢ä¸­å¯ä»¥çœ‹åˆ° åˆ›å»ºçš„ç´¢å¼•ä¿¡æ¯</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/KBlogsPro/#å››ã€javaæ“ä½œes-demo">å››ã€Javaæ“ä½œES Demo *</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/KBlogsPro/#äº”ã€esæŸ¥è¯¢">äº”ã€ESæŸ¥è¯¢ *</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_5-1-termæŸ¥è¯¢">5.1 termæŸ¥è¯¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_5-2-termsæŸ¥è¯¢">5.2 termsæŸ¥è¯¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_5-3-matchæŸ¥è¯¢">5.3 matchæŸ¥è¯¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_5-4-multi-matchæŸ¥è¯¢">5.4 multi_matchæŸ¥è¯¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_5-5-idsæŸ¥è¯¢">5.5 idsæŸ¥è¯¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_5-6-prefixæŸ¥è¯¢">5.6 prefixæŸ¥è¯¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_5-7-fuzzyæŸ¥è¯¢">5.7 fuzzyæŸ¥è¯¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_5-8-wildcardæŸ¥è¯¢">5.8 wildcardæŸ¥è¯¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_5-9-rangeæŸ¥è¯¢">5.9 rangeæŸ¥è¯¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_5-10-regexpæŸ¥è¯¢">5.10 regexpæŸ¥è¯¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_5-11-æ·±åˆ†é¡µscroll">5.11 æ·±åˆ†é¡µScroll</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_5-12-delete-by-query">5.12 delete-by-query</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_5-13-boolæŸ¥è¯¢">5.13 boolæŸ¥è¯¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_5-14-filteræŸ¥è¯¢">5.14 filteræŸ¥è¯¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_5-15-é«˜äº®æŸ¥è¯¢">5.15 é«˜äº®æŸ¥è¯¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_5-16-èšåˆæŸ¥è¯¢">5.16 èšåˆæŸ¥è¯¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/KBlogsPro/#_5-17-åœ°å›¾ç»çº¬åº¦æœç´¢">5.17 åœ°å›¾ç»çº¬åº¦æœç´¢</a></li><!----><!--]--></ul></li><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h1 id="elasticsearch" tabindex="-1"><a class="header-anchor" href="#elasticsearch" aria-hidden="true">#</a> ElasticSearch</h1><h2 id="ä¸€ã€elasticsearchæ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#ä¸€ã€elasticsearchæ˜¯ä»€ä¹ˆ" aria-hidden="true">#</a> ä¸€ã€ElasticSearchæ˜¯ä»€ä¹ˆ</h2><p>åˆ†å¸ƒå¼æœç´¢å’Œåˆ†æå¼•æ“ï¼Œä¸»è¦å®ç°è¿‘ä¹å®æ—¶çš„æœç´¢å’Œåˆ†æã€‚å¯ä»¥å®ç°æµ·é‡æ•°æ®çš„å­˜å‚¨ï¼ˆâ½€æŒPBçº§åˆ«çš„æ•°<br> æ®ï¼‰ï¼Œå¯ä»¥å®ç°å¿«é€Ÿæœç´¢ï¼ˆå€’æ’ç´¢å¼•ï¼‰è¿˜å¯ä»¥å®ç°æ•°æ®åˆ†æå¤„ç†.</p><p><strong>å®ç°æµ·é‡æ•°æ®ä¸‹å¿«é€Ÿæœç´¢</strong></p><p>ç»å¯¹ä¸ä½¿â½¤æ¨¡ç³ŠæŸ¥è¯¢ï¼Œå› ä¸ºæ€§èƒ½å¤ªä½ã€‚<br> è§£å†³æµ·é‡æ•°æ®çš„å¿«é€Ÿæœç´¢ï¼Œå°±éœ€è¦ä½¿â½¤å…¨â½‚æ£€ç´¢æŠ€æœ¯ï¼Œé€‰æ‹©ElasticSearch<br> å¸‚â¾¯ä¸Šæœ‰å…¨â½‚æ£€ç´¢æŠ€æœ¯ï¼šLuceneã€Solr(åº•å±‚ï¼šLucene)ã€ElasticSearchï¼ˆåº•å±‚ï¼šLuceneï¼‰<br> â½¬å‰å¸‚â¾¯ä¸Šï¼šElasticSearch<br> ELKï¼šElasticSearchï¼ˆå­˜å‚¨ã€æœç´¢ï¼‰+Logstashï¼ˆé‡‡é›†ï¼‰+Kibanaï¼ˆå¯è§†åŒ–ï¼‰ â½‡å¿—å¹³å°<br><strong>ä¸»è¦å­˜å‚¨çš„æŸ¥è¯¢çš„æ•°æ®ï¼Œâ½€æŒæµ·é‡æ•°æ®å­˜å‚¨å’ŒæŸ¥è¯¢ï¼Œâ¼€å®šè¦å¸¦æ¡ä»¶</strong><br> ä¸»æµï¼šElasticSearch</p><h3 id="_1-1elasticsearchçš„ç‰¹æ€§" tabindex="-1"><a class="header-anchor" href="#_1-1elasticsearchçš„ç‰¹æ€§" aria-hidden="true">#</a> 1.1Elasticsearchçš„ç‰¹æ€§</h3><p>ElasticSearchæ˜¯åŸºäºLuceneå¼€å‘çš„åˆ†å¸ƒå¼æœç´¢æ¡†æ¶ï¼ŒåŒ…å«å¦‚ä¸‹ç‰¹æ€§ï¼š</p><ol><li>åˆ†å¸ƒå¼ç´¢å¼•ã€æœç´¢ã€‚</li><li>ç´¢å¼•è‡ªåŠ¨åˆ†ç‰‡ã€è´Ÿè½½å‡è¡¡ã€‚</li><li>è‡ªåŠ¨å‘ç°æœºå™¨ã€ç»„å»ºé›†ç¾¤ã€‚</li><li>æ”¯æŒRestful é£æ ¼æ¥å£ã€‚</li><li>é…ç½®ç®€å•ç­‰ã€‚</li><li>æµ·é‡æ•°æ®çš„å­˜å‚¨ã€‚</li><li>é«˜äº®æ˜¾ç¤º</li></ol><h3 id="_1-2-åŸºæœ¬æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#_1-2-åŸºæœ¬æ¦‚å¿µ" aria-hidden="true">#</a> 1.2 åŸºæœ¬æ¦‚å¿µ</h3><p><strong>1.2.1 Index (ç´¢å¼•)</strong><br> åŠ¨è¯ ï¼Œç›¸å½“äºMysql ä¸­çš„insert<br> åè¯ï¼Œ ç›¸å½“äºMysql ä¸­çš„ Database<br><strong>1.2.2 Type ï¼ˆç±»å‹ï¼‰</strong><br> åœ¨Index(ç´¢å¼•)ä¸­ ï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ªæˆ–å¤šä¸ªç±»å‹ã€‚<br> ç±»ä¼¼Mysql ä¸­çš„table ,æ¯ä¸€ç§ç±»å‹çš„æ•°æ®æ”¾åœ¨ä¸€èµ·<br><strong>_doc: ElasticSearch æ–°ç‰ˆæœ¬é»˜è®¤çš„ç±»å‹</strong><br><strong>1.2.3 Document ï¼ˆæ–‡æ¡£ï¼‰</strong><br> ä¿å­˜åœ¨æŸä¸ªç´¢å¼•ï¼ˆindexï¼‰ä¸‹ï¼ŒæŸç§ç±»å‹ï¼ˆtypeï¼‰çš„ä¸€ä¸ªæ•°æ®ï¼ˆDocumentï¼‰ ,æ–‡æ¡£æ˜¯json æ ¼å¼çš„ï¼ŒDocument å°±åƒæ˜¯Mysql ä¸­æŸä¸ªtableé‡Œé¢çš„å†…å®¹ã€‚</p><table><thead><tr><th>MySQL</th><th>ElasticSearch</th></tr></thead><tbody><tr><td>DataBase æ•°æ®åº“</td><td>Index ç´¢å¼•</td></tr><tr><td>Table è¡¨</td><td>Type ç±»å‹</td></tr><tr><td>Row ä¸€è¡Œæ•°æ®</td><td>Document æ–‡æ¡£</td></tr></tbody></table><h3 id="_1-3-å€’æ’ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#_1-3-å€’æ’ç´¢å¼•" aria-hidden="true">#</a> 1.3 å€’æ’ç´¢å¼•</h3><figure><img src="https://steven-kz.github.io/BlogImgs/imgaes/20230812174124.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h3 id="_1-4-esç»“æ„" tabindex="-1"><a class="header-anchor" href="#_1-4-esç»“æ„" aria-hidden="true">#</a> 1.4 ESç»“æ„</h3><ul><li>ESçš„æœåŠ¡ä¸­ï¼Œå¯ä»¥åˆ›å»ºå¤šä¸ªç´¢å¼•ã€‚</li><li>æ¯ä¸€ä¸ªç´¢å¼•é»˜è®¤è¢«åˆ†æˆ5ç‰‡å­˜å‚¨ã€‚</li><li>æ¯ä¸€ä¸ªåˆ†ç‰‡éƒ½ä¼šå­˜åœ¨è‡³å°‘ä¸€ä¸ªå¤‡ä»½åˆ†ç‰‡ã€‚</li><li>å¤‡ä»½åˆ†ç‰‡é»˜è®¤ä¸ä¼šå¸®åŠ©æ£€ç´¢æ•°æ®ï¼Œå½“ESæ£€ç´¢å‹åŠ›ç‰¹åˆ«å¤§çš„æ—¶å€™ï¼Œå¤‡ä»½åˆ†ç‰‡æ‰ä¼šå¸®åŠ©æ£€ç´¢æ•°æ®ã€‚</li><li>å¤‡ä»½çš„åˆ†ç‰‡å¿…é¡»æ”¾åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸­ã€‚ç†è§£ï¼š ç´¢å¼•indexæ˜¯es ä¸­æœ€å¤§çš„æ•°æ®å­˜å‚¨å•ä½ ï¼Œå’Œmysql çš„åŒºåˆ«æ˜¯ ä¸€ä¸ªç´¢å¼•ï¼ˆindexï¼‰ä¸­å¯ä»¥å­˜æµ·é‡ï¼ˆå‡ äº¿æ¡ï¼‰æ•°æ® ï¼Œå¦‚æœæˆ‘ä»¬è¦åœ¨å‡ äº¿æ¡æ•°æ®ä¸­æ£€ç´¢å‡ºå‡ æ¡æƒ³è¦çš„æ•°æ® æ•ˆç‡ä¼šå¾ˆä½ æ‰€ä»¥ es æä¾›äº† ä¸€ç§å¯¹ç´¢å¼•è¿›è¡Œåˆ†ç‰‡çš„æœºåˆ¶ ï¼ŒES å¤©ç„¶æ”¯æŒé›†ç¾¤ï¼Œåœ¨é›†ç¾¤æœåŠ¡å™¨ä¸­ ES æŠŠä¸€ä¸ªç´¢å¼•è¿›è¡Œåˆ†ç‰‡ æ”¾åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Š å¦‚ä¸‹å›¾ ä¾‹å¦‚ æœ‰ä¸€äº¿æ¡æ•°æ® åˆ†æˆä¸¤ä¸ªåˆ†ç‰‡ æ¯ä¸ªåˆ†ç‰‡ä¸Šæœ‰5000ä¸‡æ¡æ•°æ® è¿™æ ·åšçš„å¥½å¤„ ä¸€æ˜¯ æé«˜æŸ¥è¯¢é€Ÿåº¦ äºŒæ˜¯ æé«˜æ•°æ®çš„å­˜å‚¨é‡ï¼Œå¦å¤– ä¸ºäº†ä¿è¯æ•°æ®çš„å®‰å…¨ æ¯ä¸ªä¸»åˆ†ç‰‡ä¼šæœ‰å¤‡ä»½åˆ†ç‰‡ ä¸»åˆ†ç‰‡å’Œå¤‡ä»½åˆ†ç‰‡åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Š ï¼Œ æ¯”å¦‚ ä¸»åˆ†ç‰‡2 æŒ‚æ‰äº† åœ¨ ESæœåŠ¡1 ä¸Šé¢ è¿˜æœ‰ ä¸»åˆ†ç‰‡2çš„å¤‡ä»½åˆ†ç‰‡ ï¼Œè¿™æ ·åœ¨ä¸€å®šç¨‹åº¦ä¸Šä¿è¯äº†æ•°æ®çš„å®‰å…¨æ€§ é¿å…æ•°æ®çš„ä¸¢å¤±ã€‚ä½†æ˜¯ å¦‚æœ å½“å‰é›†ç¾¤ä¸­ åªæœ‰ä¸€å°esæœåŠ¡å™¨ é‚£ä¹ˆ è¿™å°æœåŠ¡å™¨ä¸Š æ”¾çš„éƒ½æ˜¯ä¸»åˆ†ç‰‡ï¼Œæ²¡æœ‰å¤‡ä»½åˆ†ç‰‡ï¼Œä»€ä¹ˆæ—¶å€™æ‰©å±•äº†é›†ç¾¤ä¸­çš„ å¦ä¸€å°æœåŠ¡å™¨ æ‰ä¼šå­˜æ”¾å¤‡ä»½åˆ†ç‰‡ã€‚<br> | ç´¢å¼•åˆ†ç‰‡å¤‡ä»½ |<br> | --- |<br> | <img src="https://steven-kz.github.io/BlogImgs/imgaes/20230812174205.png" alt="image.png" loading="lazy"></li></ul><h2 id="äºŒã€æ­å»ºes-kibana" tabindex="-1"><a class="header-anchor" href="#äºŒã€æ­å»ºes-kibana" aria-hidden="true">#</a> äºŒã€æ­å»ºES Kibana</h2><h3 id="_2-1-å®‰è£…docker-compose" tabindex="-1"><a class="header-anchor" href="#_2-1-å®‰è£…docker-compose" aria-hidden="true">#</a> 2.1 å®‰è£…docker-compose</h3><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code>1<span class="token punctuation">.</span> cd <span class="token operator">/</span>usr/local/bin <span class="token comment">#åˆ‡æ¢åˆ°å®‰è£…è·¯å¾„</span>
2<span class="token punctuation">.</span> wget https:<span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com/docker/compose/releases/download/1<span class="token punctuation">.</span>14<span class="token punctuation">.</span>0-rc2/docker-compose-Linux-x86_64  <span class="token comment"># ä¸‹è½½å®‰è£…æº</span>
3<span class="token punctuation">.</span> rename docker-compose-Linux-x86_64 docker-compose docker-compose-Linux-x86_64 <span class="token comment"># é‡å‘½åå®‰è£…ä¸‹è½½çš„å®‰è£…åŒ…</span>
4<span class="token punctuation">.</span> chmod <span class="token operator">+</span>x <span class="token operator">/</span>usr/local/bin/docker-compose
5<span class="token punctuation">.</span> docker-compose version <span class="token comment"># æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-2-æ‹‰èµ·é•œåƒ" tabindex="-1"><a class="header-anchor" href="#_2-2-æ‹‰èµ·é•œåƒ" aria-hidden="true">#</a> 2.2 æ‹‰èµ·é•œåƒ</h3><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code>mkdir <span class="token operator">-</span>p <span class="token operator">/</span>opt/docker_elasticsearch/config
mkdir <span class="token operator">-</span>p <span class="token operator">/</span>opt/docker_elasticsearch/<span class="token keyword">data</span>
mkdir <span class="token operator">-</span>p <span class="token operator">/</span>opt/docker_elasticsearch/plugins
<span class="token function">echo</span> <span class="token string">&quot;http.host: 0.0.0.0&quot;</span>  &gt;&gt;  <span class="token operator">/</span>opt/docker_elasticsearch/config/elasticsearch<span class="token punctuation">.</span>yml
chmod 777 config
chmod 777 <span class="token keyword">data</span>
vi docker-compose<span class="token punctuation">.</span>yml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&quot;3.1&quot;</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
 <span class="token key atrule">elasticsearch</span><span class="token punctuation">:</span>
  <span class="token key atrule">image</span><span class="token punctuation">:</span> daocloud.io/library/elasticsearch<span class="token punctuation">:</span>7.4.2
  <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
  <span class="token key atrule">container_name</span><span class="token punctuation">:</span> elasticsearch
  <span class="token key atrule">environment</span><span class="token punctuation">:</span>
     <span class="token punctuation">-</span> <span class="token string">&quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot;</span>
  <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
     <span class="token punctuation">-</span> /opt/docker_elasticsearch/config/elasticsearch.yml<span class="token punctuation">:</span>/usr/share/elasticsearch/config/elasticsearch.yml
     <span class="token punctuation">-</span> /opt/docker_elasticsearch/data<span class="token punctuation">:</span>/usr/share/elasticsearch/data
     <span class="token punctuation">-</span> /opt/docker_elasticsearch/plugins<span class="token punctuation">:</span>/usr/share/elasticsearch/plugins
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
     <span class="token punctuation">-</span> 9200<span class="token punctuation">:</span><span class="token number">9200</span>
     <span class="token punctuation">-</span> 9300<span class="token punctuation">:</span><span class="token number">9300</span>
 <span class="token key atrule">kibana</span><span class="token punctuation">:</span>
   <span class="token key atrule">image</span><span class="token punctuation">:</span> daocloud.io/library/kibana<span class="token punctuation">:</span>7.4.2
   <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
   <span class="token key atrule">container_name</span><span class="token punctuation">:</span> kibana
   <span class="token key atrule">ports</span><span class="token punctuation">:</span>
     <span class="token punctuation">-</span> 5601<span class="token punctuation">:</span><span class="token number">5601</span>
   <span class="token key atrule">environment</span><span class="token punctuation">:</span>
     <span class="token punctuation">-</span> elasticsearch_url=http<span class="token punctuation">:</span>//120.26.105.43<span class="token punctuation">:</span><span class="token number">9200</span>
   <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
     <span class="token punctuation">-</span> elasticsearch
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡Œæ“ä½œymlæ–‡ä»¶æ²¡è„¸ æ‹‰å–é•œåƒ **docker-compose up -d **<br> å¯åŠ¨æ—¥å¿—ï¼š<strong>docker-compose logs -f</strong></p><figure><img src="https://steven-kz.github.io/BlogImgs/imgaes/20230812174710.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h4 id="_2-2-1-æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ" tabindex="-1"><a class="header-anchor" href="#_2-2-1-æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ" aria-hidden="true">#</a> 2.2.1 æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ</h4><p>æš‚æœªå¯åŠ¨å®Œæ¯•<br><img src="https://steven-kz.github.io/BlogImgs/imgaes/20230812174807.png" alt="image.png" loading="lazy"><br> es: <a href="http://120.26.105.43:9200/" target="_blank" rel="noopener noreferrer">http://120.26.105.43:9200/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><br> å‡ºç°jsonæ•°æ®åˆ™å¯åŠ¨æˆåŠŸ</p><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;name&quot;</span> : <span class="token string">&quot;2fd261b080fb&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;cluster_name&quot;</span> : <span class="token string">&quot;elasticsearch&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;cluster_uuid&quot;</span> : <span class="token string">&quot;k9AKmU-1QdS-3GecdD0MOg&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;version&quot;</span> : <span class="token punctuation">{</span>
    <span class="token string">&quot;number&quot;</span> : <span class="token string">&quot;7.4.2&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;build_flavor&quot;</span> : <span class="token string">&quot;default&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;build_type&quot;</span> : <span class="token string">&quot;docker&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;build_hash&quot;</span> : <span class="token string">&quot;2f90bbf7b93631e52bafb59b3b049cb44ec25e96&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;build_date&quot;</span> : <span class="token string">&quot;2019-10-28T20:40:44.881551Z&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;build_snapshot&quot;</span> : false<span class="token punctuation">,</span>
    <span class="token string">&quot;lucene_version&quot;</span> : <span class="token string">&quot;8.2.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;minimum_wire_compatibility_version&quot;</span> : <span class="token string">&quot;6.8.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;minimum_index_compatibility_version&quot;</span> : <span class="token string">&quot;6.0.0-beta1&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">&quot;tagline&quot;</span> : <span class="token string">&quot;You Know, for Search&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>kibana: <a href="http://120.26.105.43:5601/" target="_blank" rel="noopener noreferrer">http://120.26.105.43:5601/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><br> å›¾å½¢åŒ–ç•Œé¢æ“ä½œes<br><img src="https://steven-kz.github.io/BlogImgs/imgaes/20230812174853.png" alt="image.png" loading="lazy"></p><h3 id="_2-3-ikåˆ†è¯å™¨" tabindex="-1"><a class="header-anchor" href="#_2-3-ikåˆ†è¯å™¨" aria-hidden="true">#</a> 2.3 IKåˆ†è¯å™¨</h3><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code>docker exec <span class="token operator">-</span>it elasticsearch bash
cd bin/
<span class="token punctuation">.</span><span class="token operator">/</span>elasticsearch-plugin install https:<span class="token operator">/</span><span class="token operator">/</span>ghproxy<span class="token punctuation">.</span>com/https:<span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com/medcl/elasticsearch-analysis-ik/releases/download/v7<span class="token punctuation">.</span>4<span class="token punctuation">.</span>2/elasticsearch-analysis-ik-7<span class="token punctuation">.</span>4<span class="token punctuation">.</span>2<span class="token punctuation">.</span>zip
<span class="token comment"># æŸ¥çœ‹æ˜¯å¦å®‰è£…å®Œæ¯•</span>
<span class="token punctuation">.</span><span class="token operator">/</span>elasticsearch-plugin list
analysis-ik <span class="token comment"># ikåˆ†è¯å™¨</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®‰è£…å®Œæ¯•åé€€å‡ºå®¹å™¨<strong>é‡å¯es</strong> æ‰§è¡Œæ“ä½œymlæ–‡ä»¶ï¼šdocker-compose restart<br> è‹¥å®‰è£…å¤±è´¥éœ€åˆ é™¤æ’ä»¶é‡æ–°å®‰è£… binç›®å½•ä¸‹</p><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code><span class="token punctuation">.</span><span class="token operator">/</span>elasticsearch-plugin list
<span class="token punctuation">.</span><span class="token operator">/</span>elasticsearch-plugin remove analysis-ik
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-3-2-æµ‹è¯•åˆ†è¯å™¨" tabindex="-1"><a class="header-anchor" href="#_2-3-2-æµ‹è¯•åˆ†è¯å™¨" aria-hidden="true">#</a> 2.3.2 æµ‹è¯•åˆ†è¯å™¨</h4><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code><span class="token comment"># é»˜è®¤åˆ†è¯å™¨</span>
POST _analyze 
<span class="token punctuation">{</span>
  <span class="token string">&quot;text&quot;</span>: <span class="token punctuation">[</span><span class="token string">&quot;ä¸­å›½ä¼Ÿå¤§&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment"># ikåˆ†è¯å™¨</span>
<span class="token comment"># ç²—ç²’åº¦åˆ†è¯</span>
POST _analyze 
<span class="token punctuation">{</span>
  <span class="token string">&quot;text&quot;</span>: <span class="token punctuation">[</span><span class="token string">&quot;ä¸­å›½ä¼Ÿå¤§&quot;</span><span class="token punctuation">]</span>
  <span class="token punctuation">,</span> <span class="token string">&quot;analyzer&quot;</span>: <span class="token string">&quot;ik_smart&quot;</span>
<span class="token punctuation">}</span>

<span class="token comment"># ikåˆ†è¯å™¨</span>
<span class="token comment"># ç»†ç²’åº¦åˆ†è¯</span>
POST _analyze 
<span class="token punctuation">{</span>
  <span class="token string">&quot;text&quot;</span>: <span class="token punctuation">[</span><span class="token string">&quot;å¯‡å“²é‚±è¹è¹å¿«å¿«ä¹ä¹èº«ä½“å¥åº·&quot;</span><span class="token punctuation">]</span>
  <span class="token punctuation">,</span> <span class="token string">&quot;analyzer&quot;</span>: <span class="token string">&quot;ik_max_word&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-4-è®¾ç½®å¯†ç " tabindex="-1"><a class="header-anchor" href="#_2-4-è®¾ç½®å¯†ç " aria-hidden="true">#</a> 2.4 è®¾ç½®å¯†ç </h3><h4 id="_2-4-1-es-pwd" tabindex="-1"><a class="header-anchor" href="#_2-4-1-es-pwd" aria-hidden="true">#</a> 2.4.1 es pwd</h4><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code>ç¬¬ä¸€æ­¥ï¼šè¿›å…¥ESå®¹å™¨ã€‚å‘½ä»¤ï¼šdocker exec <span class="token operator">-</span>it es <span class="token operator">/</span>bin/bash
ç¬¬äºŒæ­¥ï¼šåœ¨ESçš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹é…ç½® å‘½ä»¤ï¼švi config/elasticsearch<span class="token punctuation">.</span>yml
<span class="token comment">#æ·»åŠ å¦‚ä¸‹å†…å®¹</span>
http<span class="token punctuation">.</span>cors<span class="token punctuation">.</span>enabled: true
http<span class="token punctuation">.</span>cors<span class="token punctuation">.</span>allow-origin: <span class="token string">&quot;*&quot;</span>
http<span class="token punctuation">.</span>cors<span class="token punctuation">.</span>allow-headers: Authorization
xpack<span class="token punctuation">.</span>security<span class="token punctuation">.</span>enabled: true
xpack<span class="token punctuation">.</span>security<span class="token punctuation">.</span>transport<span class="token punctuation">.</span>ssl<span class="token punctuation">.</span>enabled: true
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¬¬ä¸‰æ­¥ï¼šé‡å¯es docker restart es ä¹‹å<strong>å†æ¬¡è¿›å…¥å®¹å™¨</strong>è¾“å…¥å è®¾ç½®å¯†ç  å¤§æ¦‚10å‡ ç§</p><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code><span class="token punctuation">.</span><span class="token operator">/</span>bin/elasticsearch-setup-passwords interactive
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="https://steven-kz.github.io/BlogImgs/imgaes/20230812174952.png" alt="image.png" loading="lazy"><br> ä¿®æ”¹å¯†ç </p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>POST /_security/user/elastic/_password
<span class="token punctuation">{</span>
  <span class="token property">&quot;password&quot;</span><span class="token operator">:</span> <span class="token string">&quot;123456&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¿®æ”¹å¯†ç ä¹‹åï¼Œéœ€è¦é‡æ–°è®¾ç½®kibanaçš„é…ç½®æ–‡ä»¶ï¼Œæ‰å¯ä»¥é‡æ–°ä½¿ç”¨kibana</p><h4 id="_2-4-2-kibana-pwd" tabindex="-1"><a class="header-anchor" href="#_2-4-2-kibana-pwd" aria-hidden="true">#</a> 2.4.2 kibana pwd</h4><p>ç¬¬ä¸€æ­¥ï¼šè¿›å…¥kibanaå®¹å™¨ã€‚å‘½ä»¤ï¼šdocker exec -it kibana /bin/bash<br> ç¬¬äºŒæ­¥ï¼šé…ç½®è´¦å·å¯†ç ï¼Œåœ¨kibana.ymlé…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ã€‚ å‘½ä»¤ï¼švi config/kibana.yml</p><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code><span class="token comment">#æ·»åŠ ä»¥ä¸‹å†…å®¹</span>
elasticsearch<span class="token punctuation">.</span>username: <span class="token string">&quot;elastic&quot;</span>
elasticsearch<span class="token punctuation">.</span>password: <span class="token string">&quot;ä½ åœ¨esä¸­è®¾ç½®çš„å¯†ç &quot;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€€å‡ºå®¹å™¨ é‡å¯å³å¯</p><h2 id="ä¸‰ã€esæ“ä½œ" tabindex="-1"><a class="header-anchor" href="#ä¸‰ã€esæ“ä½œ" aria-hidden="true">#</a> ä¸‰ã€ESæ“ä½œ</h2><h3 id="_3-1-es-fieldå¯ä»¥æŒ‡å®šç±»å‹" tabindex="-1"><a class="header-anchor" href="#_3-1-es-fieldå¯ä»¥æŒ‡å®šç±»å‹" aria-hidden="true">#</a> 3.1 Es Fieldå¯ä»¥æŒ‡å®šç±»å‹</h3><p>å­—ç¬¦ä¸²ç±»å‹ï¼štextï¼šä¸€æŠŠè¢«ç”¨äºå…¨æ–‡æ£€ç´¢ã€‚ å°†å½“å‰Fieldè¿›è¡Œåˆ†è¯ã€‚<br> keywordï¼šå½“å‰Fieldä¸ä¼šè¢«åˆ†è¯ã€‚<br> æ•°å€¼ç±»å‹ï¼š<br> longï¼šå–å€¼èŒƒå›´ä¸º-9223372036854774808~922337203685477480(-2çš„63æ¬¡æ–¹åˆ°2çš„63æ¬¡æ–¹-1)ï¼Œå ç”¨8ä¸ªå­—èŠ‚<br> integerï¼šå–å€¼èŒƒå›´ä¸º-2147483648~2147483647(-2çš„31æ¬¡æ–¹åˆ°2çš„31æ¬¡æ–¹-1)ï¼Œå ç”¨4ä¸ªå­—èŠ‚<br> shortï¼šå–å€¼èŒƒå›´ä¸º-32768~32767(-2çš„15æ¬¡æ–¹åˆ°2çš„15æ¬¡æ–¹-1)ï¼Œå ç”¨2ä¸ªå­—èŠ‚<br> byteï¼šå–å€¼èŒƒå›´ä¸º-128~127(-2çš„7æ¬¡æ–¹åˆ°2çš„7æ¬¡æ–¹-1)ï¼Œå ç”¨1ä¸ªå­—èŠ‚<br> doubleï¼š1.797693e+308~ 4.9000000e-324 (e+308è¡¨ç¤ºæ˜¯ä¹˜ä»¥10çš„308æ¬¡æ–¹ï¼Œe-324è¡¨ç¤ºä¹˜ä»¥10çš„è´Ÿ324æ¬¡æ–¹)å ç”¨8ä¸ªå­—èŠ‚<br> floatï¼š3.402823e+38 ~ 1.401298e-45(e+38è¡¨ç¤ºæ˜¯ä¹˜ä»¥10çš„38æ¬¡æ–¹ï¼Œe-45è¡¨ç¤ºä¹˜ä»¥10çš„è´Ÿ45æ¬¡æ–¹)ï¼Œå ç”¨4ä¸ªå­—èŠ‚<br> half_floatï¼šç²¾åº¦æ¯”floatå°ä¸€åŠã€‚<br> scaled_floatï¼šæ ¹æ®ä¸€ä¸ªlongå’Œscaledæ¥è¡¨è¾¾ä¸€ä¸ªæµ®ç‚¹å‹ï¼Œlong-345ï¼Œscaled-100 -&gt; 3.45<br> å¸ƒå°”ç±»å‹ï¼š<br> booleanç±»å‹ï¼Œè¡¨è¾¾trueå’Œfalse<br> äºŒè¿›åˆ¶ç±»å‹ï¼š<br> binaryç±»å‹æš‚æ—¶æ”¯æŒBase64 encode string<br> æ—¶é—´ç±»å‹ï¼š<br> dateç±»å‹ï¼Œé’ˆå¯¹æ—¶é—´ç±»å‹æŒ‡å®šå…·ä½“çš„æ ¼å¼<br> format æŒ‡å®šæ—¶é—´æ ¼å¼ yyyy-MM-dd<br> èŒƒå›´ç±»å‹ï¼š<br> long_rangeï¼šèµ‹å€¼æ—¶ï¼Œæ— éœ€æŒ‡å®šå…·ä½“çš„å†…å®¹ï¼Œåªéœ€è¦å­˜å‚¨ä¸€ä¸ªèŒƒå›´å³å¯ï¼ŒæŒ‡å®šgtï¼Œltï¼Œgteï¼Œlte<br> integer_rangeï¼šåŒä¸Š<br> double_rangeï¼šåŒä¸Š<br> float_rangeï¼šåŒä¸Š<br> date_rangeï¼šåŒä¸Š<br> ip_rangeï¼šåŒä¸Š<br> ç»çº¬åº¦ç±»å‹ï¼š<br> geo_pointï¼šç”¨æ¥å­˜å‚¨ç»çº¬åº¦çš„ï¼šç»åº¦/çº¬åº¦<br> ipç±»å‹ï¼š<br> ipï¼šå¯ä»¥å­˜å‚¨IPV4æˆ–è€…IPV6<br><a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.6/mapping-types.html" target="_blank" rel="noopener noreferrer">å…¶ä»–çš„æ•°æ®ç±»å‹å‚è€ƒå®˜ç½‘(opens new window) <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="_3-2-kibanaå¿«æ·é”®æ“ä½œ" tabindex="-1"><a class="header-anchor" href="#_3-2-kibanaå¿«æ·é”®æ“ä½œ" aria-hidden="true">#</a> 3.2 Kibanaå¿«æ·é”®æ“ä½œ</h3><blockquote><p>ctrl i è‡ªåŠ¨è¡¥å…¨<br> ctrl / æ‰“å¼€å¸®åŠ©æ–‡æ¡£<br> ctrl Enter æ‰§è¡Œå½“å‰é€‰ä¸­çš„è¯·æ±‚</p></blockquote><h3 id="_3-3-ç´¢å¼•æ“ä½œ" tabindex="-1"><a class="header-anchor" href="#_3-3-ç´¢å¼•æ“ä½œ" aria-hidden="true">#</a> 3.3 ç´¢å¼•æ“ä½œ</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>
<span class="token comment"># æŸ¥çœ‹æ‰€æœ‰èŠ‚ç‚¹</span>
GET /_cat/nodes
<span class="token comment"># æŸ¥çœ‹es å¥åº·çŠ¶å†µ</span>
GET /_cat/health
<span class="token comment">#æŸ¥çœ‹ä¸»èŠ‚ç‚¹</span>
GET /_cat/master

<span class="token comment">#æŸ¥çœ‹æ‰€æœ‰ç´¢å¼•;</span>
GET /_cat/indices
<span class="token comment">#æŸ¥è¯¢ç´¢å¼•ä¿¡æ¯,ç›¸å½“äºæŸ¥çœ‹ æ•°æ®åº“è¡¨ç»“æ„</span>
GET /sms_log_test

<span class="token comment">#åˆ é™¤ç´¢å¼•</span>
DELETE book
<span class="token comment"># åˆ›å»ºç´¢å¼•,é‡å¤æ‰§è¡Œä¼šæŠ¥é”™</span>
PUT test1
<span class="token comment"># åˆ›å»ºç´¢å¼•åŒæ—¶æ‰‹åŠ¨æŒ‡å®šé…ç½®ä¿¡æ¯</span>
PUT test2
<span class="token punctuation">{</span>
<span class="token string">&quot;settings&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
<span class="token string">&quot;number_of_shards&quot;</span><span class="token builtin class-name">:</span> <span class="token number">3</span>,  åˆ†ç‰‡
<span class="token string">&quot;number_of_replicas&quot;</span><span class="token builtin class-name">:</span> <span class="token number">1</span> å¤‡ä»½
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment"># æŸ¥è¯¢ç´¢å¼•è¯¦æƒ…</span>
GET test2

<span class="token comment"># æŸ¥è¯¢æŒ‡å®šçš„æ–‡æ¡£ä¿¡æ¯ </span>
GET sms_log_test/_doc/doc_id


</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://steven-kz.github.io/BlogImgs/imgaes/20230812175123.png" alt="image.png" tabindex="0" loading="lazy"><figcaption>image.png</figcaption></figure><h4 id="_3-3-1-åˆ›å»ºæŒ‡å®šæ•°æ®ç»“æ„ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#_3-3-1-åˆ›å»ºæŒ‡å®šæ•°æ®ç»“æ„ç´¢å¼•" aria-hidden="true">#</a> 3.3.1 åˆ›å»ºæŒ‡å®šæ•°æ®ç»“æ„ç´¢å¼•</h4><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code># åˆ›å»ºç´¢å¼•ï¼ŒæŒ‡å®šæ•°æ®ç»“æ„
PUT /book
<span class="token punctuation">{</span>
  <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    # åˆ†ç‰‡æ•°
    <span class="token property">&quot;number_of_shards&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    # å¤‡ä»½æ•°
    <span class="token property">&quot;number_of_replicas&quot;</span><span class="token operator">:</span> <span class="token number">1</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  # æŒ‡å®šæ•°æ®ç»“æ„
  <span class="token property">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    # æ–‡æ¡£å­˜å‚¨çš„Field
    <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      # Fieldå±æ€§å
      <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        # ç±»å‹
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
        # æŒ‡å®šå½“å‰Fieldå¯ä»¥è¢«ä½œä¸ºæŸ¥è¯¢çš„æ¡ä»¶
        <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">,</span>
        # æ˜¯å¦éœ€è¦é¢å¤–å­˜å‚¨
        <span class="token property">&quot;store&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span> 
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;author&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        # keyword ä¹Ÿç®—æ˜¯å­—ç¬¦ä¸²ç±»å‹ 
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;count&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;long&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;on-sale&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;date&quot;</span><span class="token punctuation">,</span>
        # æ—¶é—´ç±»å‹çš„æ ¼å¼åŒ–æ–¹å¼ 
        <span class="token property">&quot;format&quot;</span><span class="token operator">:</span> <span class="token string">&quot;yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;descr&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-4-æ–‡æ¡£æ“ä½œ" tabindex="-1"><a class="header-anchor" href="#_3-4-æ–‡æ¡£æ“ä½œ" aria-hidden="true">#</a> 3.4 æ–‡æ¡£æ“ä½œ</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># æ·»åŠ æ–‡æ¡£ï¼Œæ‰‹åŠ¨æŒ‡å®šid      æ¨èä½¿ç”¨</span>
ï¼ˆå¯ä¸æŒ‡å®šId:PUT /book/_doc/ï¼‰

PUT /book/_doc/1
<span class="token punctuation">{</span>
  <span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;çº¢æ¥¼æ¢¦&quot;</span>,
  <span class="token string">&quot;author&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;æ›¹é›ªèŠ¹&quot;</span>,
  <span class="token string">&quot;count&quot;</span><span class="token builtin class-name">:</span> <span class="token number">10000000</span>,
  <span class="token string">&quot;on-sale&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;1985-01-01&quot;</span>,
  <span class="token string">&quot;descr&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;ä¸€ä¸ªæ˜¯é˜†è‹‘ä»™è‘©ï¼Œä¸€ä¸ªæ˜¯ç¾ç‰æ— ç‘•&quot;</span>
<span class="token punctuation">}</span>
<span class="token comment"># ä¿®æ”¹æ–‡æ¡£   è¦†ç›–å¼ä¿®æ”¹  å¦‚æœæ²¡æœ‰æŒ‡å®šæŸä¸ªå±æ€§ è¿™ä¸ªå±æ€§ä¼šè¢«è¦†ç›–æ‰  è¦†ç›–æ²¡äº†</span>
PUT /book/_doc/1
<span class="token punctuation">{</span>
  <span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;çº¢æ¥¼æ¢¦&quot;</span>,
  <span class="token string">&quot;author&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;æ›¹é›ªèŠ¹&quot;</span>,
  <span class="token string">&quot;count&quot;</span><span class="token builtin class-name">:</span> <span class="token number">4353453</span>,
  <span class="token string">&quot;on-sale&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;1985-01-01&quot;</span>,
  <span class="token string">&quot;descr&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;ä¸€ä¸ªæ˜¯é˜†è‹‘ä»™è‘©ï¼Œä¸€ä¸ªæ˜¯ç¾ç‰æ— ç‘•&quot;</span>
<span class="token punctuation">}</span>

<span class="token comment"># åˆ é™¤æ–‡æ¡£</span>
DELETE sms_log_test/_doc/doc_id
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-5-kibana-å¯è§†åŒ–ç•Œé¢ä¸­å¯ä»¥çœ‹åˆ°-åˆ›å»ºçš„ç´¢å¼•ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_3-5-kibana-å¯è§†åŒ–ç•Œé¢ä¸­å¯ä»¥çœ‹åˆ°-åˆ›å»ºçš„ç´¢å¼•ä¿¡æ¯" aria-hidden="true">#</a> 3.5 kibana å¯è§†åŒ–ç•Œé¢ä¸­å¯ä»¥çœ‹åˆ° åˆ›å»ºçš„ç´¢å¼•ä¿¡æ¯</h3><p><img src="https://steven-kz.github.io/BlogImgs/imgaes/20230812175210.png" alt="image.png" loading="lazy"><img src="https://steven-kz.github.io/BlogImgs/imgaes/20230812175233.png" alt="image.png" loading="lazy"><br><img src="https://steven-kz.github.io/BlogImgs/imgaes/20230812175304.png" alt="image.png" loading="lazy"><img src="https://steven-kz.github.io/BlogImgs/imgaes/20230812175330.png" alt="image.png" loading="lazy"></p><h2 id="å››ã€javaæ“ä½œes-demo" tabindex="-1"><a class="header-anchor" href="#å››ã€javaæ“ä½œes-demo" aria-hidden="true">#</a> å››ã€Javaæ“ä½œES Demo *</h2><p>Javaä»£ç å‡ä¸ºåŸå§‹æ“ä½œEsï¼Œ**é import org.springframework.data.elasticsearch.core.ElasticsearchRestTemplate; **</p><p>æ–°å¢æ–‡æ¡£ idä¸€è‡´ç›¸å½“äºupdate</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!-- ç”±äºæˆ‘ä»¬ä½¿ç”¨çš„esçš„ç‰ˆæœ¬æ˜¯7.4.2 æ‰‹åŠ¨æŒ‡å®šä¸‹ESçš„ç‰ˆæœ¬ --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>elasticsearch.version</span><span class="token punctuation">&gt;</span></span>7.4.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>elasticsearch.version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-elasticsearch<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ymlé…ç½®</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
<span class="token key atrule">elasticsearch</span><span class="token punctuation">:</span>
<span class="token comment"># æŒ‡å®šElasticSearchè¿æ¥ä¿¡æ¯</span>
<span class="token key atrule">uris</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//Ip<span class="token punctuation">:</span><span class="token number">9200</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ–¹å¼äºŒï¼šå¯†ç è¿æ¥</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">elasticsearch</span><span class="token punctuation">:</span>
  <span class="token key atrule">schema</span><span class="token punctuation">:</span> http
  <span class="token key atrule">address</span><span class="token punctuation">:</span> 120.26.105.43<span class="token punctuation">:</span><span class="token number">9200</span>
  <span class="token key atrule">connectTimeout</span><span class="token punctuation">:</span> <span class="token number">5000</span>
  <span class="token key atrule">socketTimeout</span><span class="token punctuation">:</span> <span class="token number">5000</span>
  <span class="token key atrule">connectionRequestTimeout</span><span class="token punctuation">:</span> <span class="token number">5000</span>
  <span class="token key atrule">maxConnectNum</span><span class="token punctuation">:</span> <span class="token number">100</span>
  <span class="token key atrule">maxConnectPerRoute</span><span class="token punctuation">:</span> <span class="token number">100</span>
  <span class="token key atrule">userName</span><span class="token punctuation">:</span> elastic
  <span class="token key atrule">password</span><span class="token punctuation">:</span> Kz898989
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Configuration</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ElasticSearchConfiguration</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/** åè®® */</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${elasticsearch.schema:http}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> schema<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/** é›†ç¾¤åœ°å€ï¼Œå¦‚æœæœ‰å¤šä¸ªç”¨â€œ,â€éš”å¼€ */</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${elasticsearch.address}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> address<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/** è¿æ¥è¶…æ—¶æ—¶é—´ */</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${elasticsearch.connectTimeout}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> connectTimeout<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/** Socket è¿æ¥è¶…æ—¶æ—¶é—´ */</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${elasticsearch.socketTimeout}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> socketTimeout<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/** è·å–è¿æ¥çš„è¶…æ—¶æ—¶é—´ */</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${elasticsearch.connectionRequestTimeout}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> connectionRequestTimeout<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/** æœ€å¤§è¿æ¥æ•° */</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${elasticsearch.maxConnectNum}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> maxConnectNum<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/** æœ€å¤§è·¯ç”±è¿æ¥æ•° */</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${elasticsearch.maxConnectPerRoute}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> maxConnectPerRoute<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${elasticsearch.userName}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> userName<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${elasticsearch.password}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>


    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;restHighLevelClient&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">RestHighLevelClient</span> <span class="token function">restHighLevelClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ‹†åˆ†åœ°å€</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">HttpHost</span><span class="token punctuation">&gt;</span></span> hostLists <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> hostList <span class="token operator">=</span> address<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> addr <span class="token operator">:</span> hostList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> host <span class="token operator">=</span> addr<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> port <span class="token operator">=</span> addr<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            hostLists<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpHost</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">,</span> schema<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">final</span> <span class="token class-name">CredentialsProvider</span> credentialsProvider <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BasicCredentialsProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        credentialsProvider<span class="token punctuation">.</span><span class="token function">setCredentials</span><span class="token punctuation">(</span><span class="token class-name">AuthScope</span><span class="token punctuation">.</span><span class="token constant">ANY</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">UsernamePasswordCredentials</span><span class="token punctuation">(</span>userName<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è½¬æ¢æˆ HttpHost æ•°ç»„</span>
        <span class="token class-name">HttpHost</span><span class="token punctuation">[</span><span class="token punctuation">]</span> httpHost <span class="token operator">=</span> hostLists<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpHost</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æ„å»ºè¿æ¥å¯¹è±¡</span>
        <span class="token class-name">RestClientBuilder</span> builder <span class="token operator">=</span> <span class="token class-name">RestClient</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span>httpHost<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¼‚æ­¥è¿æ¥å»¶æ—¶é…ç½®</span>
        builder<span class="token punctuation">.</span><span class="token function">setRequestConfigCallback</span><span class="token punctuation">(</span>requestConfigBuilder <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            requestConfigBuilder<span class="token punctuation">.</span><span class="token function">setConnectTimeout</span><span class="token punctuation">(</span>connectTimeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
            requestConfigBuilder<span class="token punctuation">.</span><span class="token function">setSocketTimeout</span><span class="token punctuation">(</span>socketTimeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
            requestConfigBuilder<span class="token punctuation">.</span><span class="token function">setConnectionRequestTimeout</span><span class="token punctuation">(</span>connectionRequestTimeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> requestConfigBuilder<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¼‚æ­¥è¿æ¥æ•°é…ç½®</span>
        builder<span class="token punctuation">.</span><span class="token function">setHttpClientConfigCallback</span><span class="token punctuation">(</span>httpClientBuilder <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            httpClientBuilder<span class="token punctuation">.</span><span class="token function">setMaxConnTotal</span><span class="token punctuation">(</span>maxConnectNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
            httpClientBuilder<span class="token punctuation">.</span><span class="token function">setMaxConnPerRoute</span><span class="token punctuation">(</span>maxConnectPerRoute<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> httpClientBuilder<span class="token punctuation">.</span><span class="token function">setDefaultCredentialsProvider</span><span class="token punctuation">(</span>credentialsProvider<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RestHighLevelClient</span><span class="token punctuation">(</span>builder<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">RestHighLevelClient</span> esClient<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="äº”ã€esæŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#äº”ã€esæŸ¥è¯¢" aria-hidden="true">#</a> äº”ã€ESæŸ¥è¯¢ *</h2><h3 id="_5-1-termæŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_5-1-termæŸ¥è¯¢" aria-hidden="true">#</a> 5.1 termæŸ¥è¯¢</h3><p>termçš„æŸ¥è¯¢æ˜¯ä»£è¡¨å®Œå…¨åŒ¹é…ï¼Œæœç´¢ä¹‹å‰ä¸ä¼šå¯¹ä½ æœç´¢çš„å…³é”®å­—è¿›è¡Œåˆ†è¯ï¼Œå¯¹ä½ çš„å…³é”®å­—å»æ–‡æ¡£åˆ†è¯åº“ä¸­å»åŒ¹é…å†…å®¹ã€‚</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code># æŸ¥è¯¢ 
# termå®Œæ•´åŒ¹é… ä¸è¿›è¡Œåˆ†è¯

POST sms-logs-index/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;from&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>   limit
  <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> 
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;term&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;province&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ä¸Šæµ·&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯´æ˜ï¼š term ä¸å¯¹æŸ¥è¯¢æ¡ä»¶è¿›è¡Œåˆ†è¯ï¼Œfieldæ˜¯textæˆ–è€…keyword ç±»å‹<br> åˆ†åˆ«æ˜¯ å¯¹æ–‡æ¡£å†…å®¹åˆ†è¯ï¼ˆtextï¼‰å’Œä¸åˆ†è¯(keyword)<br> å¦‚æœæŸ¥è¯¢æ˜¯keywordç±»å‹å°±ä½¿ç”¨term</p><h4 id="_5-1-2-æŸ¥è¯¢ç»“æœè¯´æ˜" tabindex="-1"><a class="header-anchor" href="#_5-1-2-æŸ¥è¯¢ç»“æœè¯´æ˜" aria-hidden="true">#</a> 5.1.2 æŸ¥è¯¢ç»“æœè¯´æ˜</h4><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code># æŸ¥è¯¢ç»“æœè¯´æ˜
<span class="token punctuation">{</span>
  <span class="token property">&quot;took&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>    # æŸ¥è¯¢ç”¨äº†<span class="token number">2</span>æ¯«ç§’
  <span class="token property">&quot;timed_out&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>    # æ˜¯å¦è¶…æ—¶  æ²¡æœ‰è¶…æ—¶
  <span class="token property">&quot;_shards&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>    # åˆ†ç‰‡ä¿¡æ¯
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>   # ä¸€å…±ä½¿ç”¨ä¸‰ä¸ªåˆ†ç‰‡
    <span class="token property">&quot;successful&quot;</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>   # æˆåŠŸäº†ä¸‰ä¸ªåˆ†ç‰‡
    <span class="token property">&quot;skipped&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>    # è·³è¿‡
    <span class="token property">&quot;failed&quot;</span> <span class="token operator">:</span> <span class="token number">0</span>      # å¤±è´¥
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>           # æŸ¥è¯¢å‘½ä¸­
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>         # æ€»å‘½ä¸­
      <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>      # å‘½ä¸­æ•°
      <span class="token property">&quot;relation&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>  # æŸ¥è¯¢å…³ç³»
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;max_score&quot;</span> <span class="token operator">:</span> <span class="token number">0.6931472</span><span class="token punctuation">,</span>    # åŒ¹é…åˆ†æ•°   åŒ¹é…åº¦è¶Šé«˜  åˆ†æ•°è¶Šé«˜
    <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;sms-logs-index&quot;</span><span class="token punctuation">,</span> ç´¢å¼•
        <span class="token property">&quot;_type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span> ç±»å‹
        <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;21&quot;</span><span class="token punctuation">,</span> 
        <span class="token property">&quot;_score&quot;</span> <span class="token operator">:</span> <span class="token number">0.6931472</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_source&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            å­˜å…¥çš„JSONæ•°æ®
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-1-3-javaæ“ä½œdemo" tabindex="-1"><a class="header-anchor" href="#_5-1-3-javaæ“ä½œdemo" aria-hidden="true">#</a> 5.1.3 javaæ“ä½œDemo</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">termSearch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">SearchRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchRequest</span><span class="token punctuation">(</span><span class="token string">&quot;sms-logs-index&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//1.ç»„è£…æŸ¥è¯¢æ¡ä»¶</span>
        <span class="token class-name">SearchSourceBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        builder<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">termQuery</span><span class="token punctuation">(</span><span class="token string">&quot;province&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;ä¸Šæµ·&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        request<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>builder<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SearchResponse</span> response <span class="token operator">=</span> esClient<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//2.response</span>
        <span class="token class-name">SearchHit</span><span class="token punctuation">[</span><span class="token punctuation">]</span> hits <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SearchHit</span> hit <span class="token operator">:</span> hits<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hit<span class="token punctuation">.</span><span class="token function">getScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-2-termsæŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_5-2-termsæŸ¥è¯¢" aria-hidden="true">#</a> 5.2 termsæŸ¥è¯¢</h3><p>termså’Œtermçš„æŸ¥è¯¢æœºåˆ¶æ˜¯ä¸€æ ·ï¼Œéƒ½ä¸ä¼šå°†æŒ‡å®šçš„æŸ¥è¯¢å…³é”®å­—è¿›è¡Œåˆ†è¯ï¼Œç›´æ¥å»åˆ†è¯åº“ä¸­åŒ¹é…ï¼Œæ‰¾åˆ°ç›¸åº”æ–‡æ¡£å†…å®¹ã€‚<br> termsæ˜¯åœ¨é’ˆå¯¹ä¸€ä¸ªå­—æ®µåŒ…å«å¤šä¸ªå€¼çš„æ—¶å€™ä½¿ç”¨ã€‚<br> termï¼šwhere province = åŒ—äº¬ï¼›<br> termsï¼šwhere province = åŒ—äº¬ or province = ï¼Ÿor province = ï¼Ÿ<br> ä¸€ä¸ªå­—æ®µå¯ä»¥ç­‰äºå¤šä¸ªå€¼ æœ‰ç‚¹ç±»ä¼¼ in<br> builder.query(QueryBuilders.<em>termsQuery</em>(&quot;province&quot;,&quot;ä¸Šæµ·&quot;,&quot;åŒ—äº¬&quot;));</p><h3 id="_5-3-matchæŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_5-3-matchæŸ¥è¯¢" aria-hidden="true">#</a> 5.3 matchæŸ¥è¯¢</h3><p>matchæŸ¥è¯¢å±äºé«˜å±‚æŸ¥è¯¢ï¼Œä»–ä¼šæ ¹æ®ä½ æŸ¥è¯¢çš„å­—æ®µç±»å‹ä¸ä¸€æ ·ï¼Œé‡‡ç”¨ä¸åŒçš„æŸ¥è¯¢æ–¹å¼ã€‚<br> matchæŸ¥è¯¢ï¼Œå®é™…åº•å±‚å°±æ˜¯å¤šä¸ªtermæŸ¥è¯¢ï¼Œå°†å¤šä¸ªtermæŸ¥è¯¢çš„ç»“æœç»™ä½ å°è£…åˆ°äº†ä¸€èµ·ã€‚</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>    public void <span class="token keyword">match</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            SearchRequest request <span class="token operator">=</span> new SearchRequest<span class="token punctuation">(</span><span class="token string">&quot;sms-logs-index&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token operator">//</span><span class="token number">1.</span>ç»„è£…æŸ¥è¯¢æ¡ä»¶
            SearchSourceBuilder builder <span class="token operator">=</span> new SearchSourceBuilder<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            builder<span class="token punctuation">.</span>query<span class="token punctuation">(</span>QueryBuilders<span class="token punctuation">.</span>matchQuery<span class="token punctuation">(</span><span class="token string">&quot;province&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;ä¸Šæµ·&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>operator<span class="token punctuation">(</span>Operator<span class="token punctuation">.</span>OR<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span>source<span class="token punctuation">(</span>builder<span class="token punctuation">)</span><span class="token punctuation">;</span>
            SearchResponse response <span class="token operator">=</span> esClient<span class="token punctuation">.</span>search<span class="token punctuation">(</span>request<span class="token punctuation">,</span> RequestOptions<span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">.</span>response
            SearchHit<span class="token punctuation">[</span><span class="token punctuation">]</span> hits <span class="token operator">=</span> response<span class="token punctuation">.</span>getHits<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>getHits<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>SearchHit hit <span class="token punctuation">:</span> hits<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                System<span class="token punctuation">.</span>err<span class="token punctuation">.</span>println<span class="token punctuation">(</span>hit<span class="token punctuation">.</span>getSourceAsString<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> catch <span class="token punctuation">(</span>Exception e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            throw new AppException<span class="token punctuation">(</span>String<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token string">&quot;æ‰¹é‡åˆ é™¤æ–‡æ¡£å¤±è´¥%s&quot;</span><span class="token punctuation">,</span>e<span class="token punctuation">.</span>getMessage<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-4-multi-matchæŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_5-4-multi-matchæŸ¥è¯¢" aria-hidden="true">#</a> 5.4 multi_matchæŸ¥è¯¢</h3><p>matché’ˆå¯¹ä¸€ä¸ªfieldåšæ£€ç´¢ï¼Œmulti_matché’ˆå¯¹å¤šä¸ªfieldè¿›è¡Œæ£€ç´¢ï¼Œå¤šä¸ªfieldå¯¹åº”ä¸€ä¸ªtextã€‚<br> é’ˆå¯¹å¤šä¸ªç´¢å¼•åŒæ—¶æŸ¥è¯¢</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>builder<span class="token punctuation">.</span>query<span class="token punctuation">(</span>QueryBuilders<span class="token punctuation">.</span>multiMatchQuery<span class="token punctuation">(</span><span class="token string">&quot;province&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;ä¸Šæµ·&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;åŒ—äº¬&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>operator<span class="token punctuation">(</span>Operator<span class="token punctuation">.</span>OR<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_5-5-idsæŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_5-5-idsæŸ¥è¯¢" aria-hidden="true">#</a> 5.5 idsæŸ¥è¯¢</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>builder<span class="token punctuation">.</span>query<span class="token punctuation">(</span>QueryBuilders<span class="token punctuation">.</span>idsQuery<span class="token punctuation">(</span><span class="token string">&quot;province&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>addIds<span class="token punctuation">(</span><span class="token string">&quot;éƒ‘å·&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_5-6-prefixæŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_5-6-prefixæŸ¥è¯¢" aria-hidden="true">#</a> 5.6 prefixæŸ¥è¯¢</h3><p>é’ˆå¯¹keywordç±»å‹ï¼Œå¯ä»¥è¿›è¡Œ<strong>å‰ç¼€æŸ¥è¯¢</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>    builder<span class="token punctuation">.</span>query<span class="token punctuation">(</span>QueryBuilders<span class="token punctuation">.</span>prefixQuery<span class="token punctuation">(</span><span class="token string">&quot;province&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;å°æ¹¾&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_5-7-fuzzyæŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_5-7-fuzzyæŸ¥è¯¢" aria-hidden="true">#</a> 5.7 fuzzyæŸ¥è¯¢</h3><p><strong>æ¨¡ç³ŠæŸ¥è¯¢</strong>ï¼Œæˆ‘ä»¬è¾“å…¥å­—ç¬¦çš„å¤§æ¦‚ï¼ˆæ¯”å¦‚ å‡ºç°é”™åˆ«å­—ï¼‰ï¼ŒESå°±å¯ä»¥å»æ ¹æ®è¾“å…¥çš„å†…å®¹å¤§æ¦‚å»åŒ¹é…ä¸€ä¸‹ç»“æœã€‚<br> prefixLengthæŒ‡å®šå‰é¢å‡ ä¸ªå­—ç¬¦æ˜¯ä¸å…è®¸å‡ºç°é”™è¯¯çš„</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>    builder<span class="token punctuation">.</span>query<span class="token punctuation">(</span>QueryBuilders<span class="token punctuation">.</span>fuzzyQuery<span class="token punctuation">(</span><span class="token string">&quot;userName&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;å¼ ä¸‰&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>prefixLength<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_5-8-wildcardæŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_5-8-wildcardæŸ¥è¯¢" aria-hidden="true">#</a> 5.8 wildcardæŸ¥è¯¢</h3><p><strong>é€šé…æŸ¥è¯¢</strong>ï¼Œå’ŒMySQLä¸­çš„likeæ˜¯ä¸€ä¸ªå¥—è·¯ï¼Œå¯ä»¥åœ¨æŸ¥è¯¢æ—¶ï¼Œåœ¨å­—ç¬¦ä¸²ä¸­æŒ‡å®šé€šé…ç¬¦*å’Œå ä½ç¬¦ï¼Ÿ<br> *å·åŒ¹é…å¤šä¸ªå­—ç¬¦ ?åŒ¹é…ä¸€ä¸ªå­—ç¬¦</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    builder<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">wildcardQuery</span><span class="token punctuation">(</span><span class="token string">&quot;userName&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;ç‹äº”*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_5-9-rangeæŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_5-9-rangeæŸ¥è¯¢" aria-hidden="true">#</a> 5.9 rangeæŸ¥è¯¢</h3><p>èŒƒå›´æŸ¥è¯¢ï¼Œåªé’ˆå¯¹æ•°å€¼ç±»å‹ï¼Œå¯¹æŸä¸€ä¸ªFieldè¿›è¡Œå¤§äºæˆ–è€…å°äºçš„èŒƒå›´æŒ‡å®š<br> å¯ä»¥ä½¿ç”¨ gtï¼š&gt; gteï¼š&gt;= ltï¼š&lt; lteï¼š&lt;=</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    builder<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">rangeQuery</span><span class="token punctuation">(</span><span class="token string">&quot;fee&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">gt</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lte</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_5-10-regexpæŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_5-10-regexpæŸ¥è¯¢" aria-hidden="true">#</a> 5.10 regexpæŸ¥è¯¢</h3><p>æ­£åˆ™æŸ¥è¯¢ï¼Œé€šè¿‡ä½ ç¼–å†™çš„æ­£åˆ™è¡¨è¾¾å¼å»åŒ¹é…å†…å®¹ã€‚ä½¿ç”¨è¾ƒå¤š æ¨¡ç³ŠæŸ¥è¯¢æ€§èƒ½è¾ƒä½<br><a href="https://www.sojson.com/regex/generate" target="_blank" rel="noopener noreferrer">https://www.sojson.com/regex/generate<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>builder<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">regexpQuery</span><span class="token punctuation">(</span><span class="token string">&quot;mobile&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;0?(13|14|15|18|17)[0-9]{9}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_5-11-æ·±åˆ†é¡µscroll" tabindex="-1"><a class="header-anchor" href="#_5-11-æ·±åˆ†é¡µscroll" aria-hidden="true">#</a> 5.11 æ·±åˆ†é¡µScroll</h3><blockquote><p>ESå¯¹from + sizeæ˜¯æœ‰é™åˆ¶çš„ï¼Œfromå’ŒsizeäºŒè€…ä¹‹å’Œä¸èƒ½è¶…è¿‡1W<br> åŸç†ï¼š</p><ul><li>from+sizeåœ¨ESæŸ¥è¯¢æ•°æ®çš„æ–¹å¼ï¼š</li><li>ç¬¬ä¸€æ­¥å…ˆå°†ç”¨æˆ·æŒ‡å®šçš„å…³é”®è¿›è¡Œåˆ†è¯ã€‚</li><li>ç¬¬äºŒæ­¥å°†è¯æ±‡å»åˆ†è¯åº“ä¸­è¿›è¡Œæ£€ç´¢ï¼Œå¾—åˆ°å¤šä¸ªæ–‡æ¡£çš„idã€‚</li><li>ç¬¬ä¸‰æ­¥å»å„ä¸ªåˆ†ç‰‡ä¸­å»æ‹‰å–æŒ‡å®šçš„<strong>å…¨éƒ¨æ•°æ®</strong>ã€‚è€—æ—¶è¾ƒé•¿ã€‚</li><li>ç¬¬å››æ­¥å°†æ•°æ®æ ¹æ®scoreè¿›è¡Œæ’åºã€‚è€—æ—¶è¾ƒé•¿ã€‚</li><li>ç¬¬äº”æ­¥æ ¹æ®fromçš„å€¼ï¼Œå°†æŸ¥è¯¢åˆ°çš„æ•°æ®èˆå¼ƒä¸€éƒ¨åˆ†ã€‚</li><li>ç¬¬å…­æ­¥è¿”å›ç»“æœã€‚</li><li>scroll+sizeåœ¨ESæŸ¥è¯¢æ•°æ®çš„æ–¹å¼ï¼š</li><li>ç¬¬ä¸€æ­¥å…ˆå°†ç”¨æˆ·æŒ‡å®šçš„å…³é”®è¿›è¡Œåˆ†è¯ã€‚</li><li>ç¬¬äºŒæ­¥å°†è¯æ±‡å»åˆ†è¯åº“ä¸­è¿›è¡Œæ£€ç´¢ï¼Œå¾—åˆ°å¤šä¸ªæ–‡æ¡£çš„idã€‚</li><li>ç¬¬ä¸‰æ­¥å°†æ–‡æ¡£çš„idå­˜æ”¾åœ¨ä¸€ä¸ªESçš„ä¸Šä¸‹æ–‡ä¸­ã€‚</li><li>ç¬¬å››æ­¥æ ¹æ®ä½ æŒ‡å®šçš„sizeçš„ä¸ªæ•°å»ESä¸­æ£€ç´¢æŒ‡å®šä¸ªæ•°çš„æ•°æ®ï¼Œæ‹¿å®Œæ•°æ®çš„æ–‡æ¡£idï¼Œä¼šä»ä¸Šä¸‹æ–‡ä¸­ç§»é™¤ã€‚</li><li>ç¬¬äº”æ­¥å¦‚æœéœ€è¦ä¸‹ä¸€é¡µæ•°æ®ï¼Œç›´æ¥å»ESçš„ä¸Šä¸‹æ–‡ä¸­ï¼Œæ‰¾åç»­å†…å®¹ã€‚</li><li>ç¬¬å…­æ­¥å¾ªç¯ç¬¬å››æ­¥å’Œç¬¬äº”æ­¥</li></ul></blockquote><p>ScrollæŸ¥è¯¢æ–¹å¼ï¼Œä¸é€‚åˆåšå®æ—¶çš„æŸ¥è¯¢</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">scroll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">SearchRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchRequest</span><span class="token punctuation">(</span><span class="token string">&quot;sms-logs-index&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//è®¾ç½®ESä¸Šä¸‹æ–‡ç”Ÿäº§æ—¶é—´</span>
            request<span class="token punctuation">.</span><span class="token function">scroll</span><span class="token punctuation">(</span><span class="token class-name">TimeValue</span><span class="token punctuation">.</span><span class="token function">timeValueMillis</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">SearchSourceBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            builder<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">matchAllQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//è®¾ç½®æ¯é¡µå±•ç¤ºå‡ æ¡æ•°æ®</span>
            builder<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>builder<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">SearchResponse</span> response <span class="token operator">=</span> esClient<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//åˆ†é¡µId</span>
            <span class="token class-name">String</span> scrollId <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getScrollId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;é¦–é¡µæ•°æ®&quot;</span><span class="token operator">+</span>scrollId<span class="token operator">+</span><span class="token string">&quot;--------------&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//2.response</span>
            <span class="token class-name">SearchHit</span><span class="token punctuation">[</span><span class="token punctuation">]</span> hits <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//ç¬¬ä¸€é¡µæ•°æ®</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SearchHit</span> hit <span class="token operator">:</span> hits<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hit<span class="token punctuation">.</span><span class="token function">getSourceAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">//ä¸‹é¡µæ•°æ®</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token class-name">SearchScrollRequest</span> scrollReq <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchScrollRequest</span><span class="token punctuation">(</span>scrollId<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">//è®¾ç½®ESä¸Šä¸‹æ–‡ç”Ÿäº§æ—¶é—´</span>
                request<span class="token punctuation">.</span><span class="token function">scroll</span><span class="token punctuation">(</span><span class="token class-name">TimeValue</span><span class="token punctuation">.</span><span class="token function">timeValueMillis</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">//å‘èµ·ä¸‹ä¸€é¡µè¯·æ±‚</span>
                <span class="token class-name">SearchResponse</span> scrollRes <span class="token operator">=</span> esClient<span class="token punctuation">.</span><span class="token function">scroll</span><span class="token punctuation">(</span>scrollReq<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">SearchHit</span><span class="token punctuation">[</span><span class="token punctuation">]</span> hits1 <span class="token operator">=</span> scrollRes<span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">//åˆ¤æ–­æŸ¥è¯¢æ˜¯å¦å­˜åœ¨æ•°æ®</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>hits1<span class="token punctuation">.</span>length<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€åä¸€é¡µ-------------&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SearchHit</span> hit1 <span class="token operator">:</span> hits1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hit1<span class="token punctuation">.</span><span class="token function">getSourceAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token comment">//æ¸…ç©ºESä¸Šä¸‹æ–‡</span>
            <span class="token class-name">ClearScrollRequest</span> clearScrollRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClearScrollRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            clearScrollRequest<span class="token punctuation">.</span><span class="token function">addScrollId</span><span class="token punctuation">(</span>scrollId<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">ClearScrollResponse</span> clearScrollResponse <span class="token operator">=</span> esClient<span class="token punctuation">.</span><span class="token function">clearScroll</span><span class="token punctuation">(</span>clearScrollRequest<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>clearScrollResponse<span class="token punctuation">.</span><span class="token function">isSucceeded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">AppException</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-12-delete-by-query" tabindex="-1"><a class="header-anchor" href="#_5-12-delete-by-query" aria-hidden="true">#</a> 5.12 delete-by-query</h3><p>æŸ¥è¯¢å¹¶åˆ é™¤</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token comment">//1. åˆ›å»ºDeleteByQueryRequest</span>
    <span class="token class-name">DeleteByQueryRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DeleteByQueryRequest</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//2. æŒ‡å®šæ£€ç´¢çš„æ¡ä»¶ å’ŒSearchRequestæŒ‡å®šQueryçš„æ–¹å¼ä¸ä¸€æ ·</span>
    request<span class="token punctuation">.</span><span class="token function">setQuery</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">rangeQuery</span><span class="token punctuation">(</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lt</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//3. æ‰§è¡Œåˆ é™¤</span>
    <span class="token class-name">BulkByScrollResponse</span> resp <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">deleteByQuery</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//4. è¾“å‡ºè¿”å›ç»“æœ</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-13-boolæŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_5-13-boolæŸ¥è¯¢" aria-hidden="true">#</a> 5.13 boolæŸ¥è¯¢</h3><blockquote><p>å¤åˆè¿‡æ»¤å™¨ï¼Œå°†ä½ çš„å¤šä¸ªæŸ¥è¯¢æ¡ä»¶ï¼Œä»¥ä¸€å®šçš„é€»è¾‘ç»„åˆåœ¨ä¸€èµ·ã€‚</p><ul><li>mustï¼š æ‰€æœ‰çš„æ¡ä»¶ï¼Œç”¨mustç»„åˆåœ¨ä¸€èµ·ï¼Œè¡¨ç¤ºAndçš„æ„æ€</li><li>must_notï¼šå°†must_notä¸­çš„æ¡ä»¶ï¼Œå…¨éƒ¨éƒ½ä¸èƒ½åŒ¹é…ï¼Œæ ‡è¯†Notçš„æ„æ€</li><li>shouldï¼šæ‰€æœ‰çš„æ¡ä»¶ï¼Œç”¨shouldç»„åˆåœ¨ä¸€èµ·ï¼Œè¡¨ç¤ºOrçš„æ„æ€</li></ul><p>must å¿…é¡»åŒæ—¶æ»¡è¶³ and<br> should ä»»æ„æ¡ä»¶ç¬¦åˆå³å¯ or<br> must_not å–å not</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">Bool</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// 1ã€åˆ›å»ºæŸ¥è¯¢è¯·æ±‚çš„å¯¹è±¡</span>
        <span class="token class-name">SearchRequest</span> searchRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchRequest</span><span class="token punctuation">(</span><span class="token string">&quot;sms-logs-index&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2ã€æŸ¥è¯¢æ¡ä»¶æ„é€ å™¨</span>
        <span class="token class-name">SearchSourceBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 3ã€è®¾ç½®æŸ¥è¯¢æ¡ä»¶</span>
        <span class="token comment">// ------------</span>
        <span class="token class-name">BoolQueryBuilder</span> boolQueryBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BoolQueryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æŸ¥è¯¢çœä»½ä¸ºæ­¦æ±‰æˆ–è€…åŒ—äº¬</span>
        boolQueryBuilder<span class="token punctuation">.</span><span class="token function">should</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">termQuery</span><span class="token punctuation">(</span><span class="token string">&quot;province&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;æ­¦æ±‰&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        boolQueryBuilder<span class="token punctuation">.</span><span class="token function">should</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">termQuery</span><span class="token punctuation">(</span><span class="token string">&quot;province&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;åŒ—äº¬&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è¿è¥å•†ä¸æ˜¯è”é€š</span>
        boolQueryBuilder<span class="token punctuation">.</span><span class="token function">mustNot</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">termQuery</span><span class="token punctuation">(</span><span class="token string">&quot;operatorId&quot;</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// smsContentä¸­åŒ…å«ä¸­å›½å’Œå¹³å®‰</span>
        boolQueryBuilder<span class="token punctuation">.</span><span class="token function">must</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">matchQuery</span><span class="token punctuation">(</span><span class="token string">&quot;smsContent&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;ä¸­å›½&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        boolQueryBuilder<span class="token punctuation">.</span><span class="token function">must</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">matchQuery</span><span class="token punctuation">(</span><span class="token string">&quot;smsContent&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;å¹³å®‰&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        builder<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>boolQueryBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ------------</span>
        searchRequest<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>builder<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 4ã€æ‰§è¡ŒæŸ¥è¯¢</span>
        <span class="token class-name">SearchResponse</span> response <span class="token operator">=</span> esClient<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>searchRequest<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 5ã€è·å–æŸ¥è¯¢ç»“æœ</span>
        <span class="token class-name">SearchHit</span><span class="token punctuation">[</span><span class="token punctuation">]</span> hits <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SearchHit</span> hit <span class="token operator">:</span> hits<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> hit<span class="token punctuation">.</span><span class="token function">getSourceAsMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-14-filteræŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_5-14-filteræŸ¥è¯¢" aria-hidden="true">#</a> 5.14 filteræŸ¥è¯¢</h3><p>è¿‡æ»¤</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>        <span class="token comment">//1. SearchRequest</span>
        <span class="token class-name">SearchRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchRequest</span><span class="token punctuation">(</span><span class="token string">&quot;sms-logs-index&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//2. æŸ¥è¯¢æ¡ä»¶</span>
        <span class="token class-name">SearchSourceBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">BoolQueryBuilder</span> boolQuery <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BoolQueryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        boolQuery<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">termQuery</span><span class="token punctuation">(</span><span class="token string">&quot;userName&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;å¼ ä¸‰&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        boolQuery<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">rangeQuery</span><span class="token punctuation">(</span><span class="token string">&quot;fee&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lte</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        builder<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>boolQuery<span class="token punctuation">)</span><span class="token punctuation">;</span>
        request<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>builder<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//3. æ‰§è¡ŒæŸ¥è¯¢</span>
        <span class="token class-name">SearchResponse</span> resp <span class="token operator">=</span> esClient<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//4. è¾“å‡ºç»“æœ</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SearchHit</span> hit <span class="token operator">:</span> resp<span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hit<span class="token punctuation">.</span><span class="token function">getSourceAsMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-15-é«˜äº®æŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_5-15-é«˜äº®æŸ¥è¯¢" aria-hidden="true">#</a> 5.15 é«˜äº®æŸ¥è¯¢</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>            <span class="token comment">//    @ResultType(PcDocument.class)</span>
            <span class="token class-name">SearchRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchRequest</span><span class="token punctuation">(</span><span class="token string">&quot;sms-logs-index&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//1.ç»„è£…æŸ¥è¯¢æ¡ä»¶</span>
            <span class="token class-name">SearchSourceBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            builder<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">matchQuery</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;æµ‹è¯•&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">HighlightBuilder</span> highlightBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HighlightBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            highlightBuilder<span class="token punctuation">.</span><span class="token function">field</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">preTags</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;font color=&#39;red&#39;&gt;&quot;</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">postTags</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;/font&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            builder<span class="token punctuation">.</span><span class="token function">highlighter</span><span class="token punctuation">(</span>highlightBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>builder<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">SearchResponse</span> response <span class="token operator">=</span> esClient<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//2.response</span>
            <span class="token class-name">SearchHit</span><span class="token punctuation">[</span><span class="token punctuation">]</span> hits <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SearchHit</span> hit <span class="token operator">:</span> hits<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hit<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hit<span class="token punctuation">.</span><span class="token function">getHighlightFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">//4. è·å–é«˜äº®æ•°æ®ï¼Œè¾“å‡º</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SearchHit</span> hit <span class="token operator">:</span> response<span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hit<span class="token punctuation">.</span><span class="token function">getHighlightFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-16-èšåˆæŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_5-16-èšåˆæŸ¥è¯¢" aria-hidden="true">#</a> 5.16 èšåˆæŸ¥è¯¢</h3><p>ESçš„èšåˆæŸ¥è¯¢å’ŒMySQLçš„èšåˆæŸ¥è¯¢ç±»ä¼¼ï¼ŒESçš„èšåˆæŸ¥è¯¢ç›¸æ¯”MySQLè¦å¼ºå¤§çš„å¤šï¼ŒESæä¾›çš„ç»Ÿè®¡æ•°æ®çš„æ–¹å¼å¤šç§å¤šæ ·<br><a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.5/search-aggregations-bucket-datehistogram-aggregation.html" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/en/elasticsearch/reference/6.5/search-aggregations-bucket-datehistogram-aggregation.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h4 id="_5-16-1-å»é‡è®¡æ•°æŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_5-16-1-å»é‡è®¡æ•°æŸ¥è¯¢" aria-hidden="true">#</a> 5.16.1 å»é‡è®¡æ•°æŸ¥è¯¢</h4><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>POST /sms-logs-index/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;distant&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> # è‡ªå®šä¹‰åç§°
      <span class="token property">&quot;cardinality&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;province&quot;</span>     # æŒ‰ç…§ field è¿›è¡Œå»é‡
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">aggregation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
<span class="token comment">//1. SearchRequest</span>
<span class="token class-name">SearchRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchRequest</span><span class="token punctuation">(</span><span class="token string">&quot;sms-logs-index&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">SearchSourceBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//2.æ„é€ æŸ¥è¯¢æ¡ä»¶</span>
builder<span class="token punctuation">.</span><span class="token function">aggregation</span><span class="token punctuation">(</span><span class="token class-name">AggregationBuilders</span><span class="token punctuation">.</span><span class="token function">cardinality</span><span class="token punctuation">(</span><span class="token string">&quot;agg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">field</span><span class="token punctuation">(</span><span class="token string">&quot;province&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
request<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>builder<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//3. æ‰§è¡ŒæŸ¥è¯¢</span>
<span class="token class-name">SearchResponse</span> resp <span class="token operator">=</span> esClient<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Cardinality</span> province <span class="token operator">=</span> resp<span class="token punctuation">.</span><span class="token function">getAggregations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;agg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">long</span> value <span class="token operator">=</span> province<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-16-2-èŒƒå›´ç»Ÿè®¡" tabindex="-1"><a class="header-anchor" href="#_5-16-2-èŒƒå›´ç»Ÿè®¡" aria-hidden="true">#</a> 5.16.2 èŒƒå›´ç»Ÿè®¡</h4><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>POST /sms-logs-index/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> # æŒ‡å®šname
      <span class="token property">&quot;range&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
        <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;fee&quot;</span><span class="token punctuation">,</span> # å­—æ®µ
        <span class="token property">&quot;ranges&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token property">&quot;to&quot;</span><span class="token operator">:</span> <span class="token number">5</span>        <span class="token comment">//å°äº</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            <span class="token property">&quot;from&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>    <span class="token comment">// å¤§äº</span>
            <span class="token property">&quot;to&quot;</span><span class="token operator">:</span> <span class="token number">10</span>      <span class="token comment">//å°äº</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            <span class="token property">&quot;from&quot;</span><span class="token operator">:</span> <span class="token number">10</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿”å›ç»“æœï¼š</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token property">&quot;aggregations&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;test&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;buckets&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;*-5.0&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;to&quot;</span> <span class="token operator">:</span> <span class="token number">5.0</span><span class="token punctuation">,</span>
          <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">4</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;5.0-10.0&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;from&quot;</span> <span class="token operator">:</span> <span class="token number">5.0</span><span class="token punctuation">,</span>
          <span class="token property">&quot;to&quot;</span> <span class="token operator">:</span> <span class="token number">10.0</span><span class="token punctuation">,</span>
          <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">8</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;10.0-*&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;from&quot;</span> <span class="token operator">:</span> <span class="token number">10.0</span><span class="token punctuation">,</span>
          <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">0</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">aggregationTwo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">//1. SearchRequest</span>
        <span class="token class-name">SearchRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchRequest</span><span class="token punctuation">(</span><span class="token string">&quot;sms-logs-index&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SearchSourceBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//2.æ„é€ æŸ¥è¯¢æ¡ä»¶                                       ç›¸å½“äºåç§°</span>
        builder<span class="token punctuation">.</span><span class="token function">aggregation</span><span class="token punctuation">(</span><span class="token class-name">AggregationBuilders</span>
                <span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">field</span><span class="token punctuation">(</span><span class="token string">&quot;fee&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">addUnboundedTo</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">addRange</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">addUnboundedFrom</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        request<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>builder<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//3. æ‰§è¡ŒæŸ¥è¯¢</span>
        <span class="token class-name">SearchResponse</span> resp <span class="token operator">=</span> esClient<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//                                         æ ¹æ®åç§°è·å–</span>
        <span class="token class-name">Range</span> test <span class="token operator">=</span> resp<span class="token punctuation">.</span><span class="token function">getAggregations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è·å–å­˜å‚¨æ¡¶</span>
        test<span class="token punctuation">.</span><span class="token function">getBuckets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>bucket <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>bucket<span class="token punctuation">.</span><span class="token function">getKeyAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>bucket<span class="token punctuation">.</span><span class="token function">getFromAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>bucket<span class="token punctuation">.</span><span class="token function">getToAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>bucket<span class="token punctuation">.</span><span class="token function">getDocCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ—¥æœŸèŒƒå›´ï¼š</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code># æ—¶é—´æ–¹å¼èŒƒå›´ç»Ÿè®¡ date_range formatæŒ‡å®šæ—¥æœŸæ ¼å¼
POST /sms-logs-index/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;agg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;date_range&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
        <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;createDate&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot; &quot;</span><span class="token operator">:</span> <span class="token string">&quot;yyyy&quot;</span><span class="token punctuation">,</span> 
        <span class="token property">&quot;ranges&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token property">&quot;to&quot;</span><span class="token operator">:</span> <span class="token number">2000</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            <span class="token property">&quot;from&quot;</span><span class="token operator">:</span> <span class="token number">2000</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ipèŒƒå›´ï¼š</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code># ipæ–¹å¼ èŒƒå›´ç»Ÿè®¡ ip_range
POST /sms-logs-index/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;agg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;ip_range&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ipAddr&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;ranges&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token property">&quot;to&quot;</span><span class="token operator">:</span> <span class="token string">&quot;127.0.0.1&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            <span class="token property">&quot;from&quot;</span><span class="token operator">:</span> <span class="token string">&quot;10.157.2&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-16-3-ç»Ÿè®¡èšåˆæŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_5-16-3-ç»Ÿè®¡èšåˆæŸ¥è¯¢" aria-hidden="true">#</a> 5.16.3 ç»Ÿè®¡èšåˆæŸ¥è¯¢</h4><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code># ç»Ÿè®¡èšåˆæŸ¥è¯¢ extended_stats
POST /sms-logs-index/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;agg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;extended_stats&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;fee&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
 
  <span class="token property">&quot;aggregations&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;agg&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;count&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
      <span class="token property">&quot;min&quot;</span> <span class="token operator">:</span> <span class="token number">3.0</span><span class="token punctuation">,</span>
      <span class="token property">&quot;max&quot;</span> <span class="token operator">:</span> <span class="token number">8.0</span><span class="token punctuation">,</span>
      <span class="token property">&quot;avg&quot;</span> <span class="token operator">:</span> <span class="token number">5.333333333333333</span><span class="token punctuation">,</span>
      <span class="token property">&quot;sum&quot;</span> <span class="token operator">:</span> <span class="token number">64.0</span><span class="token punctuation">,</span>
      <span class="token property">&quot;sum_of_squares&quot;</span> <span class="token operator">:</span> <span class="token number">376.0</span><span class="token punctuation">,</span>
      <span class="token property">&quot;variance&quot;</span> <span class="token operator">:</span> <span class="token number">2.8888888888888906</span><span class="token punctuation">,</span>
      <span class="token property">&quot;std_deviation&quot;</span> <span class="token operator">:</span> <span class="token number">1.6996731711975954</span><span class="token punctuation">,</span>
      <span class="token property">&quot;std_deviation_bounds&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;upper&quot;</span> <span class="token operator">:</span> <span class="token number">8.732679675728523</span><span class="token punctuation">,</span>
        <span class="token property">&quot;lower&quot;</span> <span class="token operator">:</span> <span class="token number">1.9339869909381422</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">extendedStats</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">//1. SearchRequest</span>
        <span class="token class-name">SearchRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchRequest</span><span class="token punctuation">(</span><span class="token string">&quot;sms-logs-index&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SearchSourceBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//2.æ„é€ æŸ¥è¯¢æ¡ä»¶                                       ç›¸å½“äºåç§°</span>
        builder<span class="token punctuation">.</span><span class="token function">aggregation</span><span class="token punctuation">(</span><span class="token class-name">AggregationBuilders</span>
                <span class="token punctuation">.</span><span class="token function">extendedStats</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">field</span><span class="token punctuation">(</span><span class="token string">&quot;fee&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        request<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>builder<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//3. æ‰§è¡ŒæŸ¥è¯¢</span>
        <span class="token class-name">SearchResponse</span> resp <span class="token operator">=</span> esClient<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ExtendedStats</span> stats <span class="token operator">=</span> resp<span class="token punctuation">.</span><span class="token function">getAggregations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">double</span> max <span class="token operator">=</span> stats<span class="token punctuation">.</span><span class="token function">getMax</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">double</span> min <span class="token operator">=</span> stats<span class="token punctuation">.</span><span class="token function">getMin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€å¤§å€¼ä¸ºï¼š&quot;</span> <span class="token operator">+</span> max <span class="token operator">+</span> <span class="token string">&quot;ï¼Œæœ€å°å€¼ä¸ºï¼š&quot;</span> <span class="token operator">+</span> min<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-17-åœ°å›¾ç»çº¬åº¦æœç´¢" tabindex="-1"><a class="header-anchor" href="#_5-17-åœ°å›¾ç»çº¬åº¦æœç´¢" aria-hidden="true">#</a> 5.17 åœ°å›¾ç»çº¬åº¦æœç´¢</h3><p>ESä¸­æä¾›äº†ä¸€ä¸ªæ•°æ®ç±»å‹ geo_pointï¼Œè¿™ä¸ªç±»å‹å°±æ˜¯ç”¨æ¥å­˜å‚¨ç»çº¬åº¦çš„ã€‚<br> åˆ›å»ºä¸€ä¸ªå¸¦geo_pointç±»å‹çš„ç´¢å¼•ï¼Œå¹¶æ·»åŠ æµ‹è¯•æ•°æ® <a href="http://api.map.baidu.com/lbsapi/getpoint/index.html" target="_blank" rel="noopener noreferrer">åæ ‡æ‹¾å–<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code># åˆ›å»ºä¸€ä¸ªç´¢å¼•ï¼ŒæŒ‡å®šä¸€ä¸ªnameï¼Œlocaiton

# åˆ›å»ºä¸€ä¸ªmapç´¢å¼•åŒ…å«ç»çº¬åº¦æ•°æ®
<span class="token constant">PUT</span> <span class="token operator">/</span>map
<span class="token punctuation">{</span>
  <span class="token string">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;number_of_shards&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token string">&quot;number_of_replicas&quot;</span><span class="token operator">:</span> <span class="token number">1</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;name&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string">&quot;location&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;geo_point&quot;</span> <span class="token comment">//ç±»å‹ä¸ºç»çº¬åº¦</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token constant">PUT</span> map<span class="token operator">/</span>_doc<span class="token operator">/</span><span class="token number">1</span>
<span class="token punctuation">{</span>
  <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;æœˆå­£å…¬å›­&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;location&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;lon&quot;</span><span class="token operator">:</span> <span class="token number">113.6368</span><span class="token punctuation">,</span>
    <span class="token string">&quot;lat&quot;</span><span class="token operator">:</span> <span class="token number">34.773985</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token constant">PUT</span> map<span class="token operator">/</span>_doc<span class="token operator">/</span><span class="token number">2</span>
<span class="token punctuation">{</span>
  <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;éƒ‘å·äººæ°‘å…¬å›­&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;location&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;lon&quot;</span><span class="token operator">:</span> <span class="token number">113.669581</span><span class="token punctuation">,</span>
    <span class="token string">&quot;lat&quot;</span><span class="token operator">:</span> <span class="token number">34.768197</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token constant">PUT</span> map<span class="token operator">/</span>_doc<span class="token operator">/</span><span class="token number">3</span>
<span class="token punctuation">{</span>
  <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ç«è½¦ç«™&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;location&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;lon&quot;</span><span class="token operator">:</span> <span class="token number">113.665988</span><span class="token punctuation">,</span>
    <span class="token string">&quot;lat&quot;</span><span class="token operator">:</span> <span class="token number">34.752776</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

# æŸ¥çœ‹æ‰€æœ‰æ•°æ®
<span class="token constant">GET</span> map<span class="token operator">/</span>_search
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ESçš„åœ°å›¾æ£€ç´¢æ–¹å¼</strong></p><table><thead><tr><th>è¯­æ³•</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>geo_distance</td><td>ç›´çº¿è·ç¦»æ£€ç´¢æ–¹å¼</td></tr><tr><td>geo_bounding_box</td><td>ä»¥ä¸¤ä¸ªç‚¹ç¡®å®šä¸€ä¸ªçŸ©å½¢ï¼Œè·å–åœ¨çŸ©å½¢å†…çš„å…¨éƒ¨æ•°æ®</td></tr><tr><td>geo_polygon</td><td>ä»¥å¤šä¸ªç‚¹ï¼Œç¡®å®šä¸€ä¸ªå¤šè¾¹å½¢ï¼Œè·å–å¤šè¾¹å½¢å†…çš„å…¨éƒ¨æ•°æ®</td></tr></tbody></table><h4 id="_5-17-1-geo-distance-ç›´çº¿è·ç¦»æ£€ç´¢æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#_5-17-1-geo-distance-ç›´çº¿è·ç¦»æ£€ç´¢æ–¹å¼" aria-hidden="true">#</a> 5.17.1 geo_distance ç›´çº¿è·ç¦»æ£€ç´¢æ–¹å¼</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token constant">POST</span> map<span class="token operator">/</span>_search
<span class="token punctuation">{</span>
  <span class="token string">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;geo_distance&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;location&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>   
        <span class="token string">&quot;lon&quot;</span><span class="token operator">:</span> <span class="token number">113.672455</span><span class="token punctuation">,</span> # ç»åº¦
        <span class="token string">&quot;lat&quot;</span><span class="token operator">:</span> <span class="token number">34.758619</span> #  çº¬åº¦
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string">&quot;distance&quot;</span><span class="token operator">:</span> <span class="token number">2000</span><span class="token punctuation">,</span> # è·ç¦» å•ä½ç±³
      <span class="token string">&quot;distance_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;arc&quot;</span> # è·ç¦»ç±»å‹ å¼§è¡Œ 
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">geoDistanceQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">//1. SearchRequest</span>
        <span class="token class-name">SearchRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchRequest</span><span class="token punctuation">(</span><span class="token string">&quot;map&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SearchSourceBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//åœ°ç†è¾¹ç•Œæ¡†æŸ¥è¯¢ç”Ÿæˆå™¨</span>
        <span class="token class-name">GeoDistanceQueryBuilder</span> location <span class="token operator">=</span> <span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">geoDistanceQuery</span><span class="token punctuation">(</span><span class="token string">&quot;location&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        location<span class="token punctuation">.</span><span class="token function">point</span><span class="token punctuation">(</span><span class="token number">34.758619</span><span class="token punctuation">,</span><span class="token number">113.672455</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">distance</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">,</span> <span class="token class-name">DistanceUnit</span><span class="token punctuation">.</span><span class="token constant">METERS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//2.æ„é€ æŸ¥è¯¢æ¡ä»¶                                       ç›¸å½“äºåç§°</span>
        builder<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>location<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//3. æ‰§è¡ŒæŸ¥è¯¢</span>
        <span class="token class-name">SearchResponse</span> resp <span class="token operator">=</span> esClient<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SearchHit</span> hit <span class="token operator">:</span> resp<span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hit<span class="token punctuation">.</span><span class="token function">getSourceAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-17-2-geo-bounding-box-ä»¥ä¸¤ä¸ªç‚¹ç¡®å®šä¸€ä¸ªçŸ©å½¢-è·å–åœ¨çŸ©å½¢å†…çš„å…¨éƒ¨æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_5-17-2-geo-bounding-box-ä»¥ä¸¤ä¸ªç‚¹ç¡®å®šä¸€ä¸ªçŸ©å½¢-è·å–åœ¨çŸ©å½¢å†…çš„å…¨éƒ¨æ•°æ®" aria-hidden="true">#</a> 5.17.2 geo_bounding_box ä»¥ä¸¤ä¸ªç‚¹ç¡®å®šä¸€ä¸ªçŸ©å½¢ï¼Œè·å–åœ¨çŸ©å½¢å†…çš„å…¨éƒ¨æ•°æ®</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code># ä¸¤ä¸ªç‚¹<span class="token punctuation">[</span>å·¦ä¸Šè§’<span class="token operator">/</span>å³ä¸‹è§’<span class="token punctuation">]</span>ç¡®å®šä¸€ä¸ªçŸ©å½¢ï¼ŒæŸ¥æ‰¾å†…éƒ¨çš„æ•°æ®
<span class="token constant">POST</span> map<span class="token operator">/</span>_search
<span class="token punctuation">{</span>
  <span class="token string">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;geo_bounding_box&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;location&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;top_left&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string">&quot;lon&quot;</span><span class="token operator">:</span> <span class="token number">113.616689</span><span class="token punctuation">,</span>
          <span class="token string">&quot;lat&quot;</span><span class="token operator">:</span> <span class="token number">34.768405</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;bottom_right&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string">&quot;lon&quot;</span><span class="token operator">:</span> <span class="token number">113.695452</span><span class="token punctuation">,</span>
          <span class="token string">&quot;lat&quot;</span><span class="token operator">:</span> <span class="token number">34.768167</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">geoBoundingBoxQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
            <span class="token comment">//1. SearchRequest</span>
            <span class="token class-name">SearchRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchRequest</span><span class="token punctuation">(</span><span class="token string">&quot;map&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">SearchSourceBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//åœ°ç†è¾¹ç•Œæ¡†æŸ¥è¯¢ç”Ÿæˆå™¨</span>
            <span class="token class-name">GeoBoundingBoxQueryBuilder</span> localhost <span class="token operator">=</span> <span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">geoBoundingBoxQuery</span><span class="token punctuation">(</span><span class="token string">&quot;location&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            localhost<span class="token punctuation">.</span><span class="token function">setCorners</span><span class="token punctuation">(</span><span class="token number">34.778486</span><span class="token punctuation">,</span><span class="token number">113.616976</span><span class="token punctuation">,</span><span class="token number">34.747645</span><span class="token punctuation">,</span><span class="token number">113.675186</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//2.æ„é€ æŸ¥è¯¢æ¡ä»¶                                       ç›¸å½“äºåç§°</span>
            builder<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>localhost<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//3. æ‰§è¡ŒæŸ¥è¯¢</span>
            <span class="token class-name">SearchResponse</span> resp <span class="token operator">=</span> esClient<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SearchHit</span> hit <span class="token operator">:</span> resp<span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hit<span class="token punctuation">.</span><span class="token function">getSourceAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-17-3-geo-polygon-ä»¥å¤šä¸ªç‚¹-ç¡®å®šä¸€ä¸ªå¤šè¾¹å½¢-è·å–å¤šè¾¹å½¢å†…çš„å…¨éƒ¨æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_5-17-3-geo-polygon-ä»¥å¤šä¸ªç‚¹-ç¡®å®šä¸€ä¸ªå¤šè¾¹å½¢-è·å–å¤šè¾¹å½¢å†…çš„å…¨éƒ¨æ•°æ®" aria-hidden="true">#</a> 5.17.3 geo_polygon ä»¥å¤šä¸ªç‚¹ï¼Œç¡®å®šä¸€ä¸ªå¤šè¾¹å½¢ï¼Œè·å–å¤šè¾¹å½¢å†…çš„å…¨éƒ¨æ•°æ®</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>	<span class="token constant">POST</span> map<span class="token operator">/</span>_search
<span class="token punctuation">{</span>
  <span class="token string">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;geo_polygon&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;location&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;points&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token string">&quot;lon&quot;</span><span class="token operator">:</span> <span class="token number">113.624306</span><span class="token punctuation">,</span>
            <span class="token string">&quot;lat&quot;</span><span class="token operator">:</span> <span class="token number">34.778486</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            <span class="token string">&quot;lon&quot;</span><span class="token operator">:</span> <span class="token number">113.616976</span><span class="token punctuation">,</span>
            <span class="token string">&quot;lat&quot;</span><span class="token operator">:</span> <span class="token number">34.768286</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            <span class="token string">&quot;lon&quot;</span><span class="token operator">:</span> <span class="token number">113.675186</span><span class="token punctuation">,</span>
            <span class="token string">&quot;lat&quot;</span><span class="token operator">:</span> <span class="token number">34.747645</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            <span class="token string">&quot;lon&quot;</span><span class="token operator">:</span> <span class="token number">113.687834</span><span class="token punctuation">,</span>
            <span class="token string">&quot;lat&quot;</span><span class="token operator">:</span> <span class="token number">34.78406</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div data-v-09fe2576><!--        <button class="convert-btn" id="pdf-convert-btn" @click="convertToPdf">è½¬æ¢PDFå¹¶ä¸‹è½½</button>--><button class="md" id="md-convert-btn" data-v-09fe2576>è½¬æ¢MDå¹¶ä¸‹è½½</button><!----><div data-v-09fe2576></div></div></div><!----><footer class="page-meta"><!----><div class="meta-item git-info"><div class="update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: knightbreeze@163.com">kou</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a aria-label="Beetl" class="vp-link nav-link prev nav-link prev" href="/KBlogsPro/java/Common/Beetl.html"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>Beetl</div></a><a aria-label="MDCé“¾è·¯è¿½è¸ª" class="vp-link nav-link next nav-link next" href="/KBlogsPro/java/Common/MDC.html"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">MDCé“¾è·¯è¿½è¸ª<span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">è”ç³»ä½œè€…wx:O000kk_</div><div class="vp-copyright">Copyright Â© 2023 Kou</div></footer></div><!--]--><!----><!----><!--]--></div>
    <script type="module" src="/KBlogsPro/assets/app-eb665f75.js" defer></script>
  </body>
</html>
